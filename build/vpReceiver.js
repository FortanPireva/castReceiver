(()=>{"use strict";const e=e=>{if(!e)return"00:00";let t=Math.floor(e/3600),s=Math.floor((e-3600*t)/60),i=Math.floor(e%60);return t?t.toString().padStart(2,"0")+":"+s.toString().padStart(2,"0")+":"+i.toString().padStart(2,"0"):s.toString().padStart(2,"0")+":"+i.toString().padStart(2,"0")};class t{static DEBUG_VAST_SERVICE="DEBUG_VAST_SERVICE";constructor(e){this.receiver=e,this.adContainer=document.querySelector(".adContainer"),this.adsDisplayContainer=null,this.adsLoader=null,this.adsDisplayInitialized=!1,this.currentAds=null,this.initialized=!1,this.autoplayAllowed=!1,this.autoplayRequiresMuted=!1,this.hasErrors=!1}init(){this.initialized=!0,google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),this.adsDisplayContainer=new google.ima.AdDisplayContainer(this.adContainer,this.receiver.video),this.adsLoader=new google.ima.AdsLoader(this.adsDisplayContainer),this.adsLoader.getSettings().setPlayerType("cast/client-side"),this.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this.onAdsManagerLoaded.bind(this),!1),this.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError,!1)}onAllAdsCompleted(e){this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE,"ad completed")}onAdCompleted(e){this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE,"ad completed"),this.adsManager.destroy(),!this.hasErrors&&this.receiver.isAdPlaying&&this.receiver.onEnd()}onContentPauseRequested(e){this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE,"Content Pause Request")}onContentResumeRequested(){this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE,"Content Resume Request")}onAdLoaded(e){this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE,"Ad loaded")}loadAds(e,s){this.currentAds={},this.initialized||this.init(),this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE,"load "+e),e?(this.currentAds.content=e,this.currentAds.type="url"):s&&(this.currentAds.content=s,this.currentAds.type="xml"),this.currentAds.currentAdIndex=0,this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE),"url"===this.currentAds.type?this.load(this.currentAds.content):this.load(null,this.currentAds.content)}load(e,s){if(this.initialized||this.init(),this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE,"Initialized"+this.vastUrl),this.adsRequest=new google.ima.AdsRequest,e)this.adsRequest.adTagUrl=e;else{if(!s)return;this.adsRequest.adsResponse=s}this.adsRequest.linearAdSlotWidth=this.receiver.video.clientWidth,this.adsRequest.linearAdSlotHeight=this.receiver.video.clientHeight,this.adsRequest.nonLinearAdSlotWidth=this.receiver.video.clientWidth,this.adsRequest.nonLinearAdSlotHeight=this.receiver.video.clientHeight/3,this.adsRequest.setAdWillAutoPlay(this.autoplayAllowed),this.adsRequest.setAdWillPlayMuted(this.autoplayRequiresMuted),this.receiver.castDebugLogger.debug("okej e qity pra","Asdf"),this.adsRequest.vastLoadTimeout=8e3,this.adsLoader.requestAds(this.adsRequest),this.receiver.castDebugLogger.debug("okej e qity pra","Asdf123")}onTimeUpdate(){this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE," ON TIME UPDATE")}onAdSkip(e){this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE,"ON AD Ski")}onAdStarted(e){this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE,"ON AD STARTED")}onAdsManagerLoaded(e){this.adsManager&&this.adsManager.destroy(),this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE," before getadsmanager");const s=new google.ima.AdsRenderingSettings;this.adsManager=e.getAdsManager(this.receiver.video,s),this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE," after getadsmanager"),this.adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this.onAdError.bind(this)),this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE," after onaderror"),this.adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,this.onContentPauseRequested.bind(this)),this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE," after onContentPauseRequested"),this.adsManager.addEventListener(google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,this.onContentResumeRequested.bind(this)),this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE," after onAllAdsCompleted"),this.adsManager.addEventListener(google.ima.AdEvent.Type.ALL_ADS_COMPLETED,this.onAllAdsCompleted.bind(this)),this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE," after onAdLoaded"),this.adsManager.addEventListener(google.ima.AdEvent.Type.LOADED,this.onAdLoaded.bind(this)),this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE," after onAdStarted"),this.adsManager.addEventListener(google.ima.AdEvent.Type.STARTED,this.onAdStarted.bind(this)),this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE," after onAdCompleted"),this.adsManager.addEventListener(google.ima.AdEvent.Type.COMPLETE,this.onAdCompleted.bind(this)),this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE," after onContentPauseRequested"),this.adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPED,this.onAdSkip.bind(this)),this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE," after onAdSkip"),this.adsManager.addEventListener(google.ima.AdEvent.Type.AD_PROGRESS,this.onTimeUpdate.bind(this)),this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE," after onTimeUpdate"),this.adsManager.addEventListener(google.ima.AdEvent.Type.AD_BUFFERING,(()=>{this.loading=!0})),this.adsManager.addEventListener(google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,(()=>{Utils.fire(this.adContainer,Events.adEvents.AD_SKIPPABLE,{currentTime:this.player.video.currentTime,adPlayId:this.adsManager.getCurrentAd()?.getAdId()})})),this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE," just before playing ad"),this.playAds()}playAds(){this.adsDisplayInitialized||(this.adsDisplayContainer.initialize(),this.adsDisplayInitialized=!0);const e=this.receiver.video.clientWidth,t=this.receiver.video.clientHeight;try{this.receiver.isAdPlaying=!0,this.adsManager.init(e,t,google.ima.ViewMode.FULLSCREEN),this.adsManager.start(),this.receiver.receiverControls.loader.style.display="none"}catch(e){this.receiver.castDebugLogger.debug(this.VastService.DEBUG_VAST_SERVICE,"AdsManager could not be started"+e.getMessage())}}onAdError(e){this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE," ad error"+e),this.hasErrors=!0,this.receiver.onEnd().bind(this.receiver)}resume(){this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE,"RESUMING AD Event"),this.adsManager&&this.adsManager.resume()}pause(){this.receiver.castDebugLogger.debug(t.DEBUG_VAST_SERVICE,"PAUSE AD Event"),this.adsManager&&this.adsManager.pause()}}const s=t;function i(t,i){let a=new class{constructor(t,i){this.context=null,this.playerManager=null,this.castDebugLogger=null,this.appId=i.appId,this.video=document.querySelector(t),this.playbackConfig=null,this.controls=null,this.hls=null,this.videoObject={},this.videoContainer=this.video.parentElement,this.playbackRate=1,this.autoplay=!1,this.receiverControls=new class{constructor(t){this.seekbar=new class{constructor(e){this.element=document.querySelector(e),this.castdebugger=null,this.show=!1}setCastDebugger(e){this.castdebugger=e}setProgress(e,t){this.element.style.width=e/t*100+"%"}showHide(e){this.castdebugger.debug("showHide",`${e} ${this.show}`),this.show?this.element.parentElement.style.display="block":setTimeout((()=>{this.element.parentElement.style.display="none"}),e)}}(".seekbar-progress"),this.timer=new class{constructor(e){this.element=document.querySelector(e),this.element.textContent="00:00 / 00:00"}update(t,s){this.element.textContent=`${e(t)} /${e(s)}`}}(".timer"),this.castDebugger=null,this.element=document.querySelector(t),this.show=!0,this.loader=document.querySelector(".loader"),this.playIcon=document.querySelector(".vp-icon-play"),this.pauseIcon=document.querySelector(".vp-icon-pause")}setCastDebugger(e){this.castDebugger=e,this.seekbar.setCastDebugger(this.castDebugger)}pause(){this.pauseIcon.style.display="none",this.playIcon.style.display="block",setTimeout((()=>{this.playIcon.style.display="none"}),2e3)}play(){this.playIcon.style.display="none",this.pauseIcon.style.display="block",setTimeout((()=>{this.pauseIcon.style.display="none"}),2e3)}update(e){this.seekbar.setProgress(e.currentTime,e.duration),this.timer.update(e.currentTime,e.duration)}hideControls(e){this.show=!1,this.showHide(e||5e3)}showControls(){this.show=!0,this.showHide(10)}showHide(e){this.show?this.element.style.display="flex":setTimeout((()=>{this.element.style.display="none"}),e)}}(".controls"),this.mediaManager=null,this.castReceiverManager=null,this.videoStarted=!1,this.vastService=new s(this),this.config={},this.debugTags={LOAD_REQUEST:"LOAD_REQUEST",ATTACH_MEDIA:"ATTACH_MEDIA",ONPLAY:"ON_PLAY",START:"START",INIT:"INIT",EVENTS:"EVENTS",ONEND:"ONEND",BROADCAST:"BROADCAST"},this.isAdPlaying=!1,this.NAMESPACE="urn:x-cast:tech.gjirafa.vp-service"}start(){this.receiverControls.loader.style.display="none",this.castDebugLogger.debug(this.debugTags.START,"Starting video..."),this.onPlay()}onPlay(){this.castDebugLogger.debug("on play",this.video.getAttribute("src")),this.castDebugLogger.debug("isadplaying",this.isAdPlaying),this.isAdPlaying?this.vastService.resume():this.video.play().then((()=>{this.videoStarted?this.receiverControls.play():(this.receiverControls.showControls(),this.videoStarted=!0),this.receiverControls.hideControls(6e3)})).catch((e=>{this.castDebugLogger.debug(this.debugTags.ONPLAY," Couldn't play video.Tring one more time "+e)}))}onPause(){this.isAdPlaying?this.vastService.pause():this.video.pause(),this.receiverControls.pause(),this.receiverControls.showControls()}addPlayerEvents(){this.video.addEventListener("timeupdate",this.onTimeUpdate),this.video.addEventListener("ended",this.onEnd.bind(this))}broadcast(e){this.castDebugLogger.debug(this.debugTags.BROADCAST,e),this.context.sendCustomMessage(this.NAMESPACE,void 0,e)}onEnd(){this.castDebugLogger.debug("on End",this.config.replay);try{this.isAdPlaying?(this.broadcast({message:"Ad finished",code:2}),this.isAdPlaying=!1):this.broadcast({message:"Video finished",code:3})}catch(e){this.castDebugLogger.error(this.debugTags.ONEND," Error"+e.toString())}return null}onTimeUpdate(){this.receiverControls.update(this.updatePlayerState())}updatePlayerState(){return{currentTime:this.video.currentTime,duration:this.videoObject.duration}}attachMedia(){if(vpReceiver.HLSsupported=Hls.isSupported(),this.castDebugLogger.debug("inside attach media",vpReceiver.HLSsupported),this.video.playbackRate=1,this.castDebugLogger.debug("video file",JSON.stringify(this.video,["id","className","tagName"])),this.videoObject.file.endsWith("mp4"))this.castDebugLogger.debug("inside mp4",this.videoObject.file),this.video.src=this.videoObject.file,this.start();else if(vpReceiver.HLSsupported){this.castDebugLogger.debug("inside hlssupported",this.videoObject.file);try{this.hls=new Hls,this.castDebugLogger.debug("hls initialized",this.videoObject.file),this.currentTime>0&&(this.video.currentTime=this.currentTime),this.hls.attachMedia(this.video),this.castDebugLogger.debug("attached media",this.videoObject.file),this.hls.on(Hls.Events.MEDIA_ATTACHED,(()=>{this.castDebugLogger.debug("amedia attached",this.videoObject.file),this.hls.startLevel=0,this.castDebugLogger.debug("loading source hlssupported",this.videoObject.file),this.hls.loadSource(this.videoObject.file)})),this.hls.on(Hls.Events.MANIFEST_PARSED,((e,t)=>{this.start()})),this.hls.on(Hls.Events.ERROR,((e,t)=>{this.castDebugLogger.debug("HLS  ERROR",t.details)}))}catch(e){}}this.castDebugLogger.debug("finished attach media")}fakeinit(){this.castDebugLogger={debug:function(e,t){console.log(e,t)},error:function(e,t){console.log(e,t)}},this.receiverControls.setCastDebugger(this.castDebugLogger),this.videoObject.file="https://vp.gjirafa.net/vps/prod/odgehtyo/encode/vjsmylds/mp4/1080p.mp4",document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen().catch((e=>{alert(`Error attempting to enable full-screen mode: ${e.message} (${e.toString()})`)})),this.attachMedia(),this.bindMethods(),this.addPlayerEvents()}init(){this.context=cast.framework.CastReceiverContext.getInstance(),this.context.setLoggerLevel(cast.framework.LoggerLevel.DEBUG),this.castDebugLogger=cast.debug.CastDebugLogger.getInstance(),this.castDebugLogger.setEnabled(!0),this.castDebugLogger.debug(this.debugTags.INIT,"castdebugger initialized"),this.playerManager=this.context.getPlayerManager(),this.playerManager.setMediaElement(this.video),this.receiverControls.setCastDebugger(this.castDebugLogger);const e=new cast.framework.CastReceiverOptions;e.customNamespaces={},e.customNamespaces[this.NAMESPACE]=cast.framework.system.MessageType.JSON,this.context.start(e),this.bindMethods(),this.bindInterceptors(),this.addPlayerEvents()}onSeek(e){this.video.currentTime=e.currentTime,this.receiverControls.showControls(),this.receiverControls.hideControls(6e3),this.receiverControls.update(this.updatePlayerState())}drawButtons(){this.controls.assignButton(cast.framework.ui.ControlsSlot.SLOT_SECONDARY_1,cast.framework.ui.ControlsButton.QUEUE_PREV),this.controls.assignButton(cast.framework.ui.ControlsSlot.SLOT_PRIMARY_1,cast.framework.ui.ControlsButton.CAPTIONS),this.controls.assignButton(cast.framework.ui.ControlsSlot.SLOT_PRIMARY_2,cast.framework.ui.ControlsButton.SEEK_FORWARD_15),this.controls.assignButton(cast.framework.ui.ControlsSlot.SLOT_SECONDARY_2,cast.framework.ui.ControlsButton.QUEUE_NEXT)}bindInterceptors(){this.context.addEventListener(cast.framework.system.EventType.SENDER_DISCONNECTED,(e=>{window.close()})),this.playerManager.setMessageInterceptor(cast.framework.messages.MessageType.LOAD,this.onLoadRequest.bind(this)),this.playerManager.setMessageInterceptor(cast.framework.messages.MessageType.PLAY,this.onPlay.bind(this)),this.playerManager.setMessageInterceptor(cast.framework.messages.MessageType.PAUSE,this.onPause.bind(this)),this.playerManager.setMessageInterceptor(cast.framework.messages.MessageType.SEEK,this.onSeek.bind(this))}bindMethods(){this.bindInterceptors=this.bindInterceptors.bind(this),this.onLoadRequest=this.onLoadRequest.bind(this),this.attachMedia=this.attachMedia.bind(this),this.start=this.start.bind(this),this.addPlayerEvents=this.addPlayerEvents.bind(this),this.onTimeUpdate=this.onTimeUpdate.bind(this),this.onPlay=this.onPlay.bind(this),this.onPause=this.onPause.bind(this),this.updatePlayerState=this.updatePlayerState.bind(this),this.onEnd=this.onEnd.bind(this)}onLoadRequest(e){this.castDebugLogger.debug("VPreceiver",e.media.contentId),this.castDebugLogger.debug("VPreceiver1",Hls.isSupported()),this.videoObject.file=e.media.contentId,this.videoObject.duration=e.media.metadata.duration,this.currentTime=e.currentTime,this.playbackRate=e.playbackRate,this.autoplay=e.autoplay,this.config.replay=void 0===e.replay||e.replay;try{if(e.customData.vastUrl||e.customData.vastXml)return this.broadcast({message:"playing ad"}),this.vastService.loadAds(e.customData.vastUrl,e.customData.vastXml),this.broadcast({message:"ad loading finished"}),this.castDebugLogger.debug(this.debugTags.LOAD_REQUEST,"Loading ad finished"),null;this.attachMedia(),this.broadcast({message:"attaching media"})}catch(e){this.broadcast({message:e.toString(),stack:e.stack})}return null}addBreaks(e){return castDebugLogger.debug(LOG_RECEIVER_TAG,"addBreaks: "+JSON.stringify(e)),fetchMediaById("fbb_ad").then((t=>{e.breakClips=[{id:"fbb_ad",title:t.title,contentUrl:t.stream.dash,contentType:"application/dash+xml",whenSkippable:5}],e.breaks=[{id:"pre-roll",breakClipIds:["fbb_ad"],position:0}]}))}fetchMediaById(e){return castDebugLogger.debug(LOG_RECEIVER_TAG,"fetching id: "+e),new Promise(((t,s)=>{fetch(CONTENT_URL).then((e=>e.json())).then((i=>{i?i[e]?t(i[e]):s(`${e} not found in repository`):s("Content repository not found.")}))}))}}(t,i);return a.fakeinit(),a}i.HLSsupported=!1,window.vpReceiver=i})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VUFDZkMsU0FBVSxPQUtsQlgsZUFBZTdJLEdBR2IsT0FGQTdFLGdCQUFnQkMsTUFBTXdOLGlCQUFrQixnQkFBa0I1SSxHQUVuRCxJQUFJeUosU0FBUSxDQUFDQyxFQUFRQyxLQUMxQkMsTUFBTUMsYUFDSDVHLE1BQU02RyxHQUFhQSxFQUFTQyxTQUM1QjlHLE1BQU0rRyxJQUNEQSxFQUNFQSxFQUFJaEssR0FDTjBKLEVBQU9NLEVBQUloSyxJQUVYMkosRUFBUSxHQUFFM0osNkJBR1oySixFQUFPLHlDRDFmVzNKLEVBQUlDLEdBRWhDLE9BREFuSCxFQUFTaU0sV0FDRmpNLEVBTFRpSCxFQUFXK0QsY0FBZSxFQVExQjZELE9BQU81SCxXQUFhQSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdnAtcmVjZWl2ZXIvLi9zcmMvanMvbW9kZWxzL3NlZWtiYXIuanMiLCJ3ZWJwYWNrOi8vdnAtcmVjZWl2ZXIvLi9zcmMvanMvaGVscGVycy9VdGlscy5qcyIsIndlYnBhY2s6Ly92cC1yZWNlaXZlci8uL3NyYy9qcy9tb2RlbHMvdmFzdFNlcnZpY2UuanMiLCJ3ZWJwYWNrOi8vdnAtcmVjZWl2ZXIvLi9zcmMvanMvdnBSZWNlaXZlci5qcyIsIndlYnBhY2s6Ly92cC1yZWNlaXZlci8uL3NyYy9qcy9tb2RlbHMvcmVjZWl2ZXIuanMiLCJ3ZWJwYWNrOi8vdnAtcmVjZWl2ZXIvLi9zcmMvanMvbW9kZWxzL3JlY2VpdmVyLWNvbnRyb2xzLmpzIiwid2VicGFjazovL3ZwLXJlY2VpdmVyLy4vc3JjL2pzL21vZGVscy90aW1lci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBTZWVrQmFyIHtcclxuICBjb25zdHJ1Y3RvcihpZCkge1xyXG4gICAgdGhpcy5lbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihpZCk7XHJcbiAgICB0aGlzLmNhc3RkZWJ1Z2dlciA9IG51bGw7XHJcbiAgICB0aGlzLnNob3cgPSBmYWxzZTtcclxuICB9XHJcbiAgc2V0Q2FzdERlYnVnZ2VyKGNhc3RkZWJ1Z2dlcikge1xyXG4gICAgdGhpcy5jYXN0ZGVidWdnZXIgPSBjYXN0ZGVidWdnZXI7XHJcbiAgfVxyXG4gIHNldFByb2dyZXNzKHRpbWUsIGR1cmF0aW9uKSB7XHJcbiAgICAvLyB0aGlzLmNhc3RkZWJ1Z2dlci5kZWJ1ZyhcImVsZVwiLCBKU09OLnN0cmluZ2lmeSh0aGlzLmVsZW1lbnQpKTtcclxuICAgIHRoaXMuZWxlbWVudC5zdHlsZS53aWR0aCA9ICh0aW1lIC8gZHVyYXRpb24pICogMTAwICsgXCIlXCI7XHJcbiAgICAvLyB0aGlzLmNhc3RkZWJ1Z2dlci5kZWJ1ZyhcIndpZHRoXCIsIHRoaXMuZWxlbWVudC5zdHlsZS53aWR0aCk7XHJcbiAgfVxyXG5cclxuICBzaG93SGlkZSh0aW1pbmcpIHtcclxuICAgIHRoaXMuY2FzdGRlYnVnZ2VyLmRlYnVnKFwic2hvd0hpZGVcIiwgYCR7dGltaW5nfSAke3RoaXMuc2hvd31gKTtcclxuICAgIGlmICh0aGlzLnNob3cpIHtcclxuICAgICAgdGhpcy5lbGVtZW50LnBhcmVudEVsZW1lbnQuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5wYXJlbnRFbGVtZW50LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgICAgfSwgdGltaW5nKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFNlZWtCYXI7XHJcbiIsImNvbnN0IGZvcm1hdFRpbWUgPSAodGltZSkgPT4ge1xyXG4gIGlmICghdGltZSkgcmV0dXJuIFwiMDA6MDBcIjtcclxuXHJcbiAgbGV0IGhvdXJzID0gTWF0aC5mbG9vcih0aW1lIC8gMzYwMCk7XHJcbiAgbGV0IG1pbnV0ZXMgPSBNYXRoLmZsb29yKCh0aW1lIC0gaG91cnMgKiAzNjAwKSAvIDYwKTtcclxuICBsZXQgc2Vjb25kcyA9IE1hdGguZmxvb3IodGltZSAlIDYwKTtcclxuXHJcbiAgLy8gZm9ybWF0IHRoZSBtaW51dGVzIGFuZCBzZWNvbmRzIHN0cmluZyB0byBsb29rIGNvbnNpc3RlbnQgYWNyb3NzIGFsbCB2YWx1ZXNcclxuICBpZiAoIWhvdXJzKSB7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICBtaW51dGVzLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgXCIwXCIpICtcclxuICAgICAgXCI6XCIgK1xyXG4gICAgICBzZWNvbmRzLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgXCIwXCIpXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIChcclxuICAgIGhvdXJzLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgXCIwXCIpICtcclxuICAgIFwiOlwiICtcclxuICAgIG1pbnV0ZXMudG9TdHJpbmcoKS5wYWRTdGFydCgyLCBcIjBcIikgK1xyXG4gICAgXCI6XCIgK1xyXG4gICAgc2Vjb25kcy50b1N0cmluZygpLnBhZFN0YXJ0KDIsIFwiMFwiKVxyXG4gICk7XHJcbn07XHJcbi8vIEZpcmUgY3VzdG9tIGV2ZW50XHJcbmNvbnN0IGZpcmUgPSAoXHJcbiAgZWwsXHJcbiAgZXZlbnROYW1lLFxyXG4gIGRldGFpbCA9IG51bGwsXHJcbiAgYnViYmxlcyA9IHRydWUsXHJcbiAgY2FuY2VsYWJsZSA9IHRydWVcclxuKSA9PiB7XHJcbiAgbGV0IGV2dCA9IG5ldyBDdXN0b21FdmVudChldmVudE5hbWUsIHtcclxuICAgIGRldGFpbCxcclxuICAgIGJ1YmJsZXMsXHJcbiAgICBjYW5jZWxhYmxlLFxyXG4gIH0pO1xyXG5cclxuICBlbC5kaXNwYXRjaEV2ZW50KGV2dCk7XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCB7XHJcbiAgZm9ybWF0VGltZSxcclxuICBmaXJlLFxyXG59O1xyXG4iLCJjbGFzcyBWYXN0U2VydmljZSB7XHJcbiAgc3RhdGljIERFQlVHX1ZBU1RfU0VSVklDRSA9IFwiREVCVUdfVkFTVF9TRVJWSUNFXCI7XHJcbiAgY29uc3RydWN0b3IocmVjZWl2ZXIpIHtcclxuICAgIHRoaXMucmVjZWl2ZXIgPSByZWNlaXZlcjtcclxuICAgIHRoaXMuYWRDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmFkQ29udGFpbmVyXCIpO1xyXG4gICAgdGhpcy5hZHNEaXNwbGF5Q29udGFpbmVyID0gbnVsbDtcclxuICAgIHRoaXMuYWRzTG9hZGVyID0gbnVsbDtcclxuICAgIHRoaXMuYWRzRGlzcGxheUluaXRpYWxpemVkID0gZmFsc2U7XHJcbiAgICB0aGlzLmN1cnJlbnRBZHMgPSBudWxsO1xyXG4gICAgdGhpcy5pbml0aWFsaXplZCA9IGZhbHNlO1xyXG4gICAgdGhpcy5hdXRvcGxheUFsbG93ZWQgPSBmYWxzZTtcclxuICAgIHRoaXMuYXV0b3BsYXlSZXF1aXJlc011dGVkID0gZmFsc2U7XHJcbiAgICB0aGlzLmhhc0Vycm9ycyA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgaW5pdCgpIHtcclxuICAgIHRoaXMuaW5pdGlhbGl6ZWQgPSB0cnVlO1xyXG4gICAgZ29vZ2xlLmltYS5zZXR0aW5ncy5zZXRWcGFpZE1vZGUoXHJcbiAgICAgIGdvb2dsZS5pbWEuSW1hU2RrU2V0dGluZ3MuVnBhaWRNb2RlLkVOQUJMRURcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5hZHNEaXNwbGF5Q29udGFpbmVyID0gbmV3IGdvb2dsZS5pbWEuQWREaXNwbGF5Q29udGFpbmVyKFxyXG4gICAgICB0aGlzLmFkQ29udGFpbmVyLFxyXG4gICAgICB0aGlzLnJlY2VpdmVyLnZpZGVvXHJcbiAgICApO1xyXG4gICAgdGhpcy5hZHNMb2FkZXIgPSBuZXcgZ29vZ2xlLmltYS5BZHNMb2FkZXIodGhpcy5hZHNEaXNwbGF5Q29udGFpbmVyKTtcclxuICAgIHRoaXMuYWRzTG9hZGVyLmdldFNldHRpbmdzKCkuc2V0UGxheWVyVHlwZShcImNhc3QvY2xpZW50LXNpZGVcIik7XHJcbiAgICB0aGlzLmFkc0xvYWRlci5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgICBnb29nbGUuaW1hLkFkc01hbmFnZXJMb2FkZWRFdmVudC5UeXBlLkFEU19NQU5BR0VSX0xPQURFRCxcclxuICAgICAgdGhpcy5vbkFkc01hbmFnZXJMb2FkZWQuYmluZCh0aGlzKSxcclxuICAgICAgZmFsc2VcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5hZHNMb2FkZXIuYWRkRXZlbnRMaXN0ZW5lcihcclxuICAgICAgZ29vZ2xlLmltYS5BZEVycm9yRXZlbnQuVHlwZS5BRF9FUlJPUixcclxuICAgICAgdGhpcy5vbkFkRXJyb3IsXHJcbiAgICAgIGZhbHNlXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgb25BbGxBZHNDb21wbGV0ZWQoZSkge1xyXG4gICAgdGhpcy5yZWNlaXZlci5jYXN0RGVidWdMb2dnZXIuZGVidWcoXHJcbiAgICAgIFZhc3RTZXJ2aWNlLkRFQlVHX1ZBU1RfU0VSVklDRSxcclxuICAgICAgXCJhZCBjb21wbGV0ZWRcIlxyXG4gICAgKTtcclxuICB9XHJcbiAgb25BZENvbXBsZXRlZChlKSB7XHJcbiAgICB0aGlzLnJlY2VpdmVyLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhcclxuICAgICAgVmFzdFNlcnZpY2UuREVCVUdfVkFTVF9TRVJWSUNFLFxyXG4gICAgICBcImFkIGNvbXBsZXRlZFwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5hZHNNYW5hZ2VyLmRlc3Ryb3koKTtcclxuICAgIGlmICghdGhpcy5oYXNFcnJvcnMgJiYgdGhpcy5yZWNlaXZlci5pc0FkUGxheWluZykgdGhpcy5yZWNlaXZlci5vbkVuZCgpO1xyXG4gICAgLy8gdGhpcy5hZHNNYW5hZ2VyLmRlc3Ryb3koKTtcclxuICAgIC8vIHRoaXMucmVjZWl2ZXIucGxheWVyTWFuYWdlci5zYGV0TWVkaWFFbGVtZW50KHRoaXMudmlkZW8pO1xyXG4gIH1cclxuICBvbkNvbnRlbnRQYXVzZVJlcXVlc3RlZChlKSB7XHJcbiAgICB0aGlzLnJlY2VpdmVyLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhcclxuICAgICAgVmFzdFNlcnZpY2UuREVCVUdfVkFTVF9TRVJWSUNFLFxyXG4gICAgICBcIkNvbnRlbnQgUGF1c2UgUmVxdWVzdFwiXHJcbiAgICApO1xyXG4gIH1cclxuICBvbkNvbnRlbnRSZXN1bWVSZXF1ZXN0ZWQoKSB7XHJcbiAgICB0aGlzLnJlY2VpdmVyLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhcclxuICAgICAgVmFzdFNlcnZpY2UuREVCVUdfVkFTVF9TRVJWSUNFLFxyXG4gICAgICBcIkNvbnRlbnQgUmVzdW1lIFJlcXVlc3RcIlxyXG4gICAgKTtcclxuICB9XHJcbiAgb25BZExvYWRlZChlKSB7XHJcbiAgICB0aGlzLnJlY2VpdmVyLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhcclxuICAgICAgVmFzdFNlcnZpY2UuREVCVUdfVkFTVF9TRVJWSUNFLFxyXG4gICAgICBcIkFkIGxvYWRlZFwiXHJcbiAgICApO1xyXG4gIH1cclxuICBsb2FkQWRzKHZhc3RVcmwsIHZhc3RYbWwpIHtcclxuICAgIHRoaXMuY3VycmVudEFkcyA9IHt9O1xyXG4gICAgaWYgKCF0aGlzLmluaXRpYWxpemVkKSB7XHJcbiAgICAgIHRoaXMuaW5pdCgpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5yZWNlaXZlci5jYXN0RGVidWdMb2dnZXIuZGVidWcoXHJcbiAgICAgIFZhc3RTZXJ2aWNlLkRFQlVHX1ZBU1RfU0VSVklDRSxcclxuICAgICAgXCJsb2FkIFwiICsgdmFzdFVybFxyXG4gICAgKTtcclxuXHJcbiAgICBpZiAodmFzdFVybCkge1xyXG4gICAgICB0aGlzLmN1cnJlbnRBZHMuY29udGVudCA9IHZhc3RVcmw7XHJcbiAgICAgIHRoaXMuY3VycmVudEFkcy50eXBlID0gXCJ1cmxcIjtcclxuICAgIH0gZWxzZSBpZiAodmFzdFhtbCkge1xyXG4gICAgICB0aGlzLmN1cnJlbnRBZHMuY29udGVudCA9IHZhc3RYbWw7XHJcbiAgICAgIHRoaXMuY3VycmVudEFkcy50eXBlID0gXCJ4bWxcIjtcclxuICAgIH1cclxuICAgIHRoaXMuY3VycmVudEFkcy5jdXJyZW50QWRJbmRleCA9IDA7XHJcbiAgICB0aGlzLnJlY2VpdmVyLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhWYXN0U2VydmljZS5ERUJVR19WQVNUX1NFUlZJQ0UpO1xyXG4gICAgaWYgKHRoaXMuY3VycmVudEFkcy50eXBlID09PSBcInVybFwiKSB0aGlzLmxvYWQodGhpcy5jdXJyZW50QWRzLmNvbnRlbnQpO1xyXG4gICAgZWxzZSB0aGlzLmxvYWQobnVsbCwgdGhpcy5jdXJyZW50QWRzLmNvbnRlbnQpO1xyXG4gIH1cclxuICBsb2FkKHZhc3RVcmwsIHZhc3RYbWwpIHtcclxuICAgIGlmICghdGhpcy5pbml0aWFsaXplZCkgdGhpcy5pbml0KCk7XHJcbiAgICB0aGlzLnJlY2VpdmVyLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhcclxuICAgICAgVmFzdFNlcnZpY2UuREVCVUdfVkFTVF9TRVJWSUNFLFxyXG4gICAgICBcIkluaXRpYWxpemVkXCIgKyB0aGlzLnZhc3RVcmxcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5hZHNSZXF1ZXN0ID0gbmV3IGdvb2dsZS5pbWEuQWRzUmVxdWVzdCgpO1xyXG4gICAgaWYgKHZhc3RVcmwpIHtcclxuICAgICAgdGhpcy5hZHNSZXF1ZXN0LmFkVGFnVXJsID0gdmFzdFVybDtcclxuICAgIH0gZWxzZSBpZiAodmFzdFhtbCkge1xyXG4gICAgICB0aGlzLmFkc1JlcXVlc3QuYWRzUmVzcG9uc2UgPSB2YXN0WG1sO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuYWRzUmVxdWVzdC5saW5lYXJBZFNsb3RXaWR0aCA9IHRoaXMucmVjZWl2ZXIudmlkZW8uY2xpZW50V2lkdGg7XHJcbiAgICB0aGlzLmFkc1JlcXVlc3QubGluZWFyQWRTbG90SGVpZ2h0ID0gdGhpcy5yZWNlaXZlci52aWRlby5jbGllbnRIZWlnaHQ7XHJcbiAgICB0aGlzLmFkc1JlcXVlc3Qubm9uTGluZWFyQWRTbG90V2lkdGggPSB0aGlzLnJlY2VpdmVyLnZpZGVvLmNsaWVudFdpZHRoO1xyXG4gICAgdGhpcy5hZHNSZXF1ZXN0Lm5vbkxpbmVhckFkU2xvdEhlaWdodCA9XHJcbiAgICAgIHRoaXMucmVjZWl2ZXIudmlkZW8uY2xpZW50SGVpZ2h0IC8gMztcclxuXHJcbiAgICB0aGlzLmFkc1JlcXVlc3Quc2V0QWRXaWxsQXV0b1BsYXkodGhpcy5hdXRvcGxheUFsbG93ZWQpO1xyXG4gICAgdGhpcy5hZHNSZXF1ZXN0LnNldEFkV2lsbFBsYXlNdXRlZCh0aGlzLmF1dG9wbGF5UmVxdWlyZXNNdXRlZCk7XHJcbiAgICB0aGlzLnJlY2VpdmVyLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhcIm9rZWogZSBxaXR5IHByYVwiLCBcIkFzZGZcIik7XHJcblxyXG4gICAgdGhpcy5hZHNSZXF1ZXN0LnZhc3RMb2FkVGltZW91dCA9IDgwMDA7XHJcbiAgICB0aGlzLmFkc0xvYWRlci5yZXF1ZXN0QWRzKHRoaXMuYWRzUmVxdWVzdCk7XHJcbiAgICB0aGlzLnJlY2VpdmVyLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhcIm9rZWogZSBxaXR5IHByYVwiLCBcIkFzZGYxMjNcIik7XHJcbiAgfVxyXG4gIG9uVGltZVVwZGF0ZSgpIHtcclxuICAgIHRoaXMucmVjZWl2ZXIuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFxyXG4gICAgICBWYXN0U2VydmljZS5ERUJVR19WQVNUX1NFUlZJQ0UsXHJcbiAgICAgIFwiIE9OIFRJTUUgVVBEQVRFXCJcclxuICAgICk7XHJcbiAgfVxyXG4gIG9uQWRTa2lwKGUpIHtcclxuICAgIHRoaXMucmVjZWl2ZXIuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFxyXG4gICAgICBWYXN0U2VydmljZS5ERUJVR19WQVNUX1NFUlZJQ0UsXHJcbiAgICAgIFwiT04gQUQgU2tpXCJcclxuICAgICk7XHJcbiAgfVxyXG4gIG9uQWRTdGFydGVkKGUpIHtcclxuICAgIHRoaXMucmVjZWl2ZXIuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFxyXG4gICAgICBWYXN0U2VydmljZS5ERUJVR19WQVNUX1NFUlZJQ0UsXHJcbiAgICAgIFwiT04gQUQgU1RBUlRFRFwiXHJcbiAgICApO1xyXG4gIH1cclxuICBvbkFkc01hbmFnZXJMb2FkZWQoYWRzTWFuYWdlckxvYWRlZEV2ZW50KSB7XHJcbiAgICBpZiAodGhpcy5hZHNNYW5hZ2VyKSB7XHJcbiAgICAgIHRoaXMuYWRzTWFuYWdlci5kZXN0cm95KCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLnJlY2VpdmVyLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhcclxuICAgICAgVmFzdFNlcnZpY2UuREVCVUdfVkFTVF9TRVJWSUNFLFxyXG4gICAgICBcIiBiZWZvcmUgZ2V0YWRzbWFuYWdlclwiXHJcbiAgICApO1xyXG4gICAgY29uc3QgYWRzUmVuZGVyaW5nU2V0dGluZ3MgPSBuZXcgZ29vZ2xlLmltYS5BZHNSZW5kZXJpbmdTZXR0aW5ncygpO1xyXG4gICAgdGhpcy5hZHNNYW5hZ2VyID0gYWRzTWFuYWdlckxvYWRlZEV2ZW50LmdldEFkc01hbmFnZXIoXHJcbiAgICAgIHRoaXMucmVjZWl2ZXIudmlkZW8sXHJcbiAgICAgIGFkc1JlbmRlcmluZ1NldHRpbmdzXHJcbiAgICApO1xyXG4gICAgdGhpcy5yZWNlaXZlci5jYXN0RGVidWdMb2dnZXIuZGVidWcoXHJcbiAgICAgIFZhc3RTZXJ2aWNlLkRFQlVHX1ZBU1RfU0VSVklDRSxcclxuICAgICAgXCIgYWZ0ZXIgZ2V0YWRzbWFuYWdlclwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5hZHNNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoXHJcbiAgICAgIGdvb2dsZS5pbWEuQWRFcnJvckV2ZW50LlR5cGUuQURfRVJST1IsXHJcbiAgICAgIHRoaXMub25BZEVycm9yLmJpbmQodGhpcylcclxuICAgICk7XHJcbiAgICB0aGlzLnJlY2VpdmVyLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhcclxuICAgICAgVmFzdFNlcnZpY2UuREVCVUdfVkFTVF9TRVJWSUNFLFxyXG4gICAgICBcIiBhZnRlciBvbmFkZXJyb3JcIlxyXG4gICAgKTtcclxuICAgIHRoaXMuYWRzTWFuYWdlci5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgICBnb29nbGUuaW1hLkFkRXZlbnQuVHlwZS5DT05URU5UX1BBVVNFX1JFUVVFU1RFRCxcclxuICAgICAgdGhpcy5vbkNvbnRlbnRQYXVzZVJlcXVlc3RlZC5iaW5kKHRoaXMpXHJcbiAgICApO1xyXG4gICAgdGhpcy5yZWNlaXZlci5jYXN0RGVidWdMb2dnZXIuZGVidWcoXHJcbiAgICAgIFZhc3RTZXJ2aWNlLkRFQlVHX1ZBU1RfU0VSVklDRSxcclxuICAgICAgXCIgYWZ0ZXIgb25Db250ZW50UGF1c2VSZXF1ZXN0ZWRcIlxyXG4gICAgKTtcclxuICAgIHRoaXMuYWRzTWFuYWdlci5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgICBnb29nbGUuaW1hLkFkRXZlbnQuVHlwZS5DT05URU5UX1JFU1VNRV9SRVFVRVNURUQsXHJcbiAgICAgIHRoaXMub25Db250ZW50UmVzdW1lUmVxdWVzdGVkLmJpbmQodGhpcylcclxuICAgICk7XHJcbiAgICB0aGlzLnJlY2VpdmVyLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhcclxuICAgICAgVmFzdFNlcnZpY2UuREVCVUdfVkFTVF9TRVJWSUNFLFxyXG4gICAgICBcIiBhZnRlciBvbkFsbEFkc0NvbXBsZXRlZFwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5hZHNNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoXHJcbiAgICAgIGdvb2dsZS5pbWEuQWRFdmVudC5UeXBlLkFMTF9BRFNfQ09NUExFVEVELFxyXG4gICAgICB0aGlzLm9uQWxsQWRzQ29tcGxldGVkLmJpbmQodGhpcylcclxuICAgICk7XHJcbiAgICB0aGlzLnJlY2VpdmVyLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhcclxuICAgICAgVmFzdFNlcnZpY2UuREVCVUdfVkFTVF9TRVJWSUNFLFxyXG4gICAgICBcIiBhZnRlciBvbkFkTG9hZGVkXCJcclxuICAgICk7XHJcbiAgICB0aGlzLmFkc01hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcihcclxuICAgICAgZ29vZ2xlLmltYS5BZEV2ZW50LlR5cGUuTE9BREVELFxyXG4gICAgICB0aGlzLm9uQWRMb2FkZWQuYmluZCh0aGlzKVxyXG4gICAgKTtcclxuICAgIHRoaXMucmVjZWl2ZXIuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFxyXG4gICAgICBWYXN0U2VydmljZS5ERUJVR19WQVNUX1NFUlZJQ0UsXHJcbiAgICAgIFwiIGFmdGVyIG9uQWRTdGFydGVkXCJcclxuICAgICk7XHJcbiAgICB0aGlzLmFkc01hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcihcclxuICAgICAgZ29vZ2xlLmltYS5BZEV2ZW50LlR5cGUuU1RBUlRFRCxcclxuICAgICAgdGhpcy5vbkFkU3RhcnRlZC5iaW5kKHRoaXMpXHJcbiAgICApO1xyXG4gICAgdGhpcy5yZWNlaXZlci5jYXN0RGVidWdMb2dnZXIuZGVidWcoXHJcbiAgICAgIFZhc3RTZXJ2aWNlLkRFQlVHX1ZBU1RfU0VSVklDRSxcclxuICAgICAgXCIgYWZ0ZXIgb25BZENvbXBsZXRlZFwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5hZHNNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoXHJcbiAgICAgIGdvb2dsZS5pbWEuQWRFdmVudC5UeXBlLkNPTVBMRVRFLFxyXG4gICAgICB0aGlzLm9uQWRDb21wbGV0ZWQuYmluZCh0aGlzKVxyXG4gICAgKTtcclxuICAgIHRoaXMucmVjZWl2ZXIuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFxyXG4gICAgICBWYXN0U2VydmljZS5ERUJVR19WQVNUX1NFUlZJQ0UsXHJcbiAgICAgIFwiIGFmdGVyIG9uQ29udGVudFBhdXNlUmVxdWVzdGVkXCJcclxuICAgICk7XHJcbiAgICB0aGlzLmFkc01hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcihcclxuICAgICAgZ29vZ2xlLmltYS5BZEV2ZW50LlR5cGUuU0tJUFBFRCxcclxuICAgICAgdGhpcy5vbkFkU2tpcC5iaW5kKHRoaXMpXHJcbiAgICApO1xyXG4gICAgdGhpcy5yZWNlaXZlci5jYXN0RGVidWdMb2dnZXIuZGVidWcoXHJcbiAgICAgIFZhc3RTZXJ2aWNlLkRFQlVHX1ZBU1RfU0VSVklDRSxcclxuICAgICAgXCIgYWZ0ZXIgb25BZFNraXBcIlxyXG4gICAgKTtcclxuICAgIHRoaXMuYWRzTWFuYWdlci5hZGRFdmVudExpc3RlbmVyKFxyXG4gICAgICBnb29nbGUuaW1hLkFkRXZlbnQuVHlwZS5BRF9QUk9HUkVTUyxcclxuICAgICAgdGhpcy5vblRpbWVVcGRhdGUuYmluZCh0aGlzKVxyXG4gICAgKTtcclxuICAgIHRoaXMucmVjZWl2ZXIuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFxyXG4gICAgICBWYXN0U2VydmljZS5ERUJVR19WQVNUX1NFUlZJQ0UsXHJcbiAgICAgIFwiIGFmdGVyIG9uVGltZVVwZGF0ZVwiXHJcbiAgICApO1xyXG4gICAgdGhpcy5hZHNNYW5hZ2VyLmFkZEV2ZW50TGlzdGVuZXIoXHJcbiAgICAgIGdvb2dsZS5pbWEuQWRFdmVudC5UeXBlLkFEX0JVRkZFUklORyxcclxuICAgICAgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgICB0aGlzLmFkc01hbmFnZXIuYWRkRXZlbnRMaXN0ZW5lcihcclxuICAgICAgZ29vZ2xlLmltYS5BZEV2ZW50LlR5cGUuU0tJUFBBQkxFX1NUQVRFX0NIQU5HRUQsXHJcbiAgICAgICgpID0+IHtcclxuICAgICAgICBVdGlscy5maXJlKHRoaXMuYWRDb250YWluZXIsIEV2ZW50cy5hZEV2ZW50cy5BRF9TS0lQUEFCTEUsIHtcclxuICAgICAgICAgIGN1cnJlbnRUaW1lOiB0aGlzLnBsYXllci52aWRlby5jdXJyZW50VGltZSxcclxuICAgICAgICAgIGFkUGxheUlkOiB0aGlzLmFkc01hbmFnZXIuZ2V0Q3VycmVudEFkKCk/LmdldEFkSWQoKSxcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgKTtcclxuICAgIHRoaXMucmVjZWl2ZXIuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFxyXG4gICAgICBWYXN0U2VydmljZS5ERUJVR19WQVNUX1NFUlZJQ0UsXHJcbiAgICAgIFwiIGp1c3QgYmVmb3JlIHBsYXlpbmcgYWRcIlxyXG4gICAgKTtcclxuICAgIHRoaXMucGxheUFkcygpO1xyXG4gIH1cclxuICBwbGF5QWRzKCkge1xyXG4gICAgaWYgKCF0aGlzLmFkc0Rpc3BsYXlJbml0aWFsaXplZCkge1xyXG4gICAgICB0aGlzLmFkc0Rpc3BsYXlDb250YWluZXIuaW5pdGlhbGl6ZSgpO1xyXG4gICAgICB0aGlzLmFkc0Rpc3BsYXlJbml0aWFsaXplZCA9IHRydWU7XHJcbiAgICB9XHJcbiAgICBjb25zdCB3aWR0aCA9IHRoaXMucmVjZWl2ZXIudmlkZW8uY2xpZW50V2lkdGg7XHJcbiAgICBjb25zdCBoZWlnaHQgPSB0aGlzLnJlY2VpdmVyLnZpZGVvLmNsaWVudEhlaWdodDtcclxuICAgIHRyeSB7XHJcbiAgICAgIHRoaXMucmVjZWl2ZXIuaXNBZFBsYXlpbmcgPSB0cnVlO1xyXG4gICAgICB0aGlzLmFkc01hbmFnZXIuaW5pdCh3aWR0aCwgaGVpZ2h0LCBnb29nbGUuaW1hLlZpZXdNb2RlLkZVTExTQ1JFRU4pO1xyXG4gICAgICB0aGlzLmFkc01hbmFnZXIuc3RhcnQoKTtcclxuICAgICAgdGhpcy5yZWNlaXZlci5yZWNlaXZlckNvbnRyb2xzLmxvYWRlci5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XHJcbiAgICB9IGNhdGNoIChhZEVycm9yKSB7XHJcbiAgICAgIHRoaXMucmVjZWl2ZXIuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFxyXG4gICAgICAgIHRoaXMuVmFzdFNlcnZpY2UuREVCVUdfVkFTVF9TRVJWSUNFLFxyXG4gICAgICAgIFwiQWRzTWFuYWdlciBjb3VsZCBub3QgYmUgc3RhcnRlZFwiICsgYWRFcnJvci5nZXRNZXNzYWdlKClcclxuICAgICAgKTtcclxuICAgIH1cclxuICB9XHJcbiAgb25BZEVycm9yKGUpIHtcclxuICAgIHRoaXMucmVjZWl2ZXIuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFxyXG4gICAgICBWYXN0U2VydmljZS5ERUJVR19WQVNUX1NFUlZJQ0UsXHJcbiAgICAgIFwiIGFkIGVycm9yXCIgKyBlXHJcbiAgICApO1xyXG4gICAgdGhpcy5oYXNFcnJvcnMgPSB0cnVlO1xyXG4gICAgdGhpcy5yZWNlaXZlci5vbkVuZCgpLmJpbmQodGhpcy5yZWNlaXZlcik7XHJcbiAgfVxyXG4gIHJlc3VtZSgpIHtcclxuICAgIHRoaXMucmVjZWl2ZXIuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFxyXG4gICAgICBWYXN0U2VydmljZS5ERUJVR19WQVNUX1NFUlZJQ0UsXHJcbiAgICAgIFwiUkVTVU1JTkcgQUQgRXZlbnRcIlxyXG4gICAgKTtcclxuICAgIGlmICghdGhpcy5hZHNNYW5hZ2VyKSByZXR1cm47XHJcbiAgICB0aGlzLmFkc01hbmFnZXIucmVzdW1lKCk7XHJcbiAgfVxyXG4gIHBhdXNlKCkge1xyXG4gICAgdGhpcy5yZWNlaXZlci5jYXN0RGVidWdMb2dnZXIuZGVidWcoXHJcbiAgICAgIFZhc3RTZXJ2aWNlLkRFQlVHX1ZBU1RfU0VSVklDRSxcclxuICAgICAgXCJQQVVTRSBBRCBFdmVudFwiXHJcbiAgICApO1xyXG4gICAgaWYgKCF0aGlzLmFkc01hbmFnZXIpIHJldHVybjtcclxuICAgIHRoaXMuYWRzTWFuYWdlci5wYXVzZSgpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgVmFzdFNlcnZpY2U7XHJcbiIsImltcG9ydCBSZWNlaXZlciBmcm9tIFwiLi9tb2RlbHMvcmVjZWl2ZXJcIjtcclxuXHJcbi8vYSBib29sZWFuIHRlbGxpbmcgd2hldGhlciBITFMgaXMgc3VwcG9ydGVkIGluIHRoZSBicm93c2VyXHJcbnZwUmVjZWl2ZXIuSExTc3VwcG9ydGVkID0gZmFsc2U7XHJcblxyXG5mdW5jdGlvbiB2cFJlY2VpdmVyKGlkLCBjb25maWcpIHtcclxuICBsZXQgcmVjZWl2ZXIgPSBuZXcgUmVjZWl2ZXIoaWQsIGNvbmZpZyk7XHJcbiAgcmVjZWl2ZXIuZmFrZWluaXQoKTtcclxuICByZXR1cm4gcmVjZWl2ZXI7XHJcbn1cclxuXHJcbndpbmRvdy52cFJlY2VpdmVyID0gdnBSZWNlaXZlcjtcclxuIiwiaW1wb3J0IGhsc2NvbmZpZyBmcm9tIFwiLi4vY29uZmlnL2hsc0NvbmZpZ1wiO1xyXG5pbXBvcnQgUmVjZWl2ZXJDb250cm9scyBmcm9tIFwiLi9yZWNlaXZlci1jb250cm9sc1wiO1xyXG5pbXBvcnQgVmFzdFNlcnZpY2UgZnJvbSBcIi4vdmFzdFNlcnZpY2VcIjtcclxuY2xhc3MgUmVjZWl2ZXIge1xyXG4gIGNvbnN0cnVjdG9yKGlkLCBjb25maWcpIHtcclxuICAgIHRoaXMuY29udGV4dCA9IG51bGw7XHJcbiAgICB0aGlzLnBsYXllck1hbmFnZXIgPSBudWxsO1xyXG4gICAgdGhpcy5jYXN0RGVidWdMb2dnZXIgPSBudWxsO1xyXG4gICAgdGhpcy5hcHBJZCA9IGNvbmZpZy5hcHBJZDtcclxuICAgIHRoaXMudmlkZW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGlkKTtcclxuICAgIHRoaXMucGxheWJhY2tDb25maWcgPSBudWxsO1xyXG4gICAgdGhpcy5jb250cm9scyA9IG51bGw7XHJcbiAgICB0aGlzLmhscyA9IG51bGw7XHJcbiAgICB0aGlzLnZpZGVvT2JqZWN0ID0ge307XHJcbiAgICB0aGlzLnZpZGVvQ29udGFpbmVyID0gdGhpcy52aWRlby5wYXJlbnRFbGVtZW50O1xyXG4gICAgdGhpcy5wbGF5YmFja1JhdGUgPSAxO1xyXG4gICAgdGhpcy5hdXRvcGxheSA9IGZhbHNlO1xyXG4gICAgdGhpcy5yZWNlaXZlckNvbnRyb2xzID0gbmV3IFJlY2VpdmVyQ29udHJvbHMoXCIuY29udHJvbHNcIik7XHJcbiAgICB0aGlzLm1lZGlhTWFuYWdlciA9IG51bGw7XHJcbiAgICB0aGlzLmNhc3RSZWNlaXZlck1hbmFnZXIgPSBudWxsO1xyXG4gICAgdGhpcy52aWRlb1N0YXJ0ZWQgPSBmYWxzZTtcclxuICAgIHRoaXMudmFzdFNlcnZpY2UgPSBuZXcgVmFzdFNlcnZpY2UodGhpcyk7XHJcbiAgICB0aGlzLmNvbmZpZyA9IHt9O1xyXG4gICAgdGhpcy5kZWJ1Z1RhZ3MgPSB7XHJcbiAgICAgIExPQURfUkVRVUVTVDogXCJMT0FEX1JFUVVFU1RcIixcclxuICAgICAgQVRUQUNIX01FRElBOiBcIkFUVEFDSF9NRURJQVwiLFxyXG4gICAgICBPTlBMQVk6IFwiT05fUExBWVwiLFxyXG4gICAgICBTVEFSVDogXCJTVEFSVFwiLFxyXG4gICAgICBJTklUOiBcIklOSVRcIixcclxuICAgICAgRVZFTlRTOiBcIkVWRU5UU1wiLFxyXG4gICAgICBPTkVORDogXCJPTkVORFwiLFxyXG4gICAgICBCUk9BRENBU1Q6IFwiQlJPQURDQVNUXCIsXHJcbiAgICB9O1xyXG4gICAgdGhpcy5pc0FkUGxheWluZyA9IGZhbHNlO1xyXG4gICAgdGhpcy5OQU1FU1BBQ0UgPSBcInVybjp4LWNhc3Q6dGVjaC5namlyYWZhLnZwLXNlcnZpY2VcIjtcclxuICB9XHJcbiAgc3RhcnQoKSB7XHJcbiAgICB0aGlzLnJlY2VpdmVyQ29udHJvbHMubG9hZGVyLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgIHRoaXMuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKHRoaXMuZGVidWdUYWdzLlNUQVJULCBcIlN0YXJ0aW5nIHZpZGVvLi4uXCIpO1xyXG4gICAgdGhpcy5vblBsYXkoKTtcclxuICB9XHJcblxyXG4gIG9uUGxheSgpIHtcclxuICAgIC8vIHJldHVybiB0aGlzLnBsYXllck1hbmFnZXIucGxheSgpO1xyXG4gICAgdGhpcy5jYXN0RGVidWdMb2dnZXIuZGVidWcoXCJvbiBwbGF5XCIsIHRoaXMudmlkZW8uZ2V0QXR0cmlidXRlKFwic3JjXCIpKTtcclxuICAgIHRoaXMuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFwiaXNhZHBsYXlpbmdcIiwgdGhpcy5pc0FkUGxheWluZyk7XHJcbiAgICBpZiAoIXRoaXMuaXNBZFBsYXlpbmcpIHtcclxuICAgICAgdGhpcy52aWRlb1xyXG4gICAgICAgIC5wbGF5KClcclxuICAgICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgICBpZiAoIXRoaXMudmlkZW9TdGFydGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVjZWl2ZXJDb250cm9scy5zaG93Q29udHJvbHMoKTtcclxuICAgICAgICAgICAgdGhpcy52aWRlb1N0YXJ0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5yZWNlaXZlckNvbnRyb2xzLnBsYXkoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRoaXMucmVjZWl2ZXJDb250cm9scy5oaWRlQ29udHJvbHMoNjAwMCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGUpID0+IHtcclxuICAgICAgICAgIHRoaXMuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFxyXG4gICAgICAgICAgICB0aGlzLmRlYnVnVGFncy5PTlBMQVksXHJcbiAgICAgICAgICAgIFwiIENvdWxkbid0IHBsYXkgdmlkZW8uVHJpbmcgb25lIG1vcmUgdGltZSBcIiArIGVcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9IGVsc2UgdGhpcy52YXN0U2VydmljZS5yZXN1bWUoKTtcclxuICB9XHJcbiAgb25QYXVzZSgpIHtcclxuICAgIGlmICghdGhpcy5pc0FkUGxheWluZykgdGhpcy52aWRlby5wYXVzZSgpO1xyXG4gICAgZWxzZSB7XHJcbiAgICAgIHRoaXMudmFzdFNlcnZpY2UucGF1c2UoKTtcclxuICAgIH1cclxuICAgIHRoaXMucmVjZWl2ZXJDb250cm9scy5wYXVzZSgpO1xyXG4gICAgdGhpcy5yZWNlaXZlckNvbnRyb2xzLnNob3dDb250cm9scygpO1xyXG4gIH1cclxuICBhZGRQbGF5ZXJFdmVudHMoKSB7XHJcbiAgICB0aGlzLnZpZGVvLmFkZEV2ZW50TGlzdGVuZXIoXCJ0aW1ldXBkYXRlXCIsIHRoaXMub25UaW1lVXBkYXRlKTtcclxuICAgIHRoaXMudmlkZW8uYWRkRXZlbnRMaXN0ZW5lcihcImVuZGVkXCIsIHRoaXMub25FbmQuYmluZCh0aGlzKSk7XHJcbiAgfVxyXG4gIGJyb2FkY2FzdChtZXNzYWdlKSB7XHJcbiAgICB0aGlzLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1Zyh0aGlzLmRlYnVnVGFncy5CUk9BRENBU1QsIG1lc3NhZ2UpO1xyXG4gICAgdGhpcy5jb250ZXh0LnNlbmRDdXN0b21NZXNzYWdlKHRoaXMuTkFNRVNQQUNFLCB1bmRlZmluZWQsIG1lc3NhZ2UpO1xyXG4gIH1cclxuICBvbkVuZCgpIHtcclxuICAgIHRoaXMuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFwib24gRW5kXCIsIHRoaXMuY29uZmlnLnJlcGxheSk7XHJcbiAgICB0cnkge1xyXG4gICAgICBpZiAodGhpcy5pc0FkUGxheWluZykge1xyXG4gICAgICAgIHRoaXMuYnJvYWRjYXN0KHtcclxuICAgICAgICAgIG1lc3NhZ2U6IFwiQWQgZmluaXNoZWRcIixcclxuICAgICAgICAgIGNvZGU6IDIsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5pc0FkUGxheWluZyA9IGZhbHNlO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRoaXMuYnJvYWRjYXN0KHtcclxuICAgICAgICAgIG1lc3NhZ2U6IFwiVmlkZW8gZmluaXNoZWRcIixcclxuICAgICAgICAgIGNvZGU6IDMsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMuY2FzdERlYnVnTG9nZ2VyLmVycm9yKFxyXG4gICAgICAgIHRoaXMuZGVidWdUYWdzLk9ORU5ELFxyXG4gICAgICAgIFwiIEVycm9yXCIgKyBlcnJvci50b1N0cmluZygpXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICAgIC8vIHRoaXMuYXR0YWNoTWVkaWEoKTtcclxuICB9XHJcbiAgb25UaW1lVXBkYXRlKCkge1xyXG4gICAgdGhpcy5yZWNlaXZlckNvbnRyb2xzLnVwZGF0ZSh0aGlzLnVwZGF0ZVBsYXllclN0YXRlKCkpO1xyXG4gIH1cclxuICB1cGRhdGVQbGF5ZXJTdGF0ZSgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIGN1cnJlbnRUaW1lOiB0aGlzLnZpZGVvLmN1cnJlbnRUaW1lLFxyXG4gICAgICBkdXJhdGlvbjogdGhpcy52aWRlb09iamVjdC5kdXJhdGlvbixcclxuICAgIH07XHJcbiAgfVxyXG4gIGF0dGFjaE1lZGlhKCkge1xyXG4gICAgdnBSZWNlaXZlci5ITFNzdXBwb3J0ZWQgPSBIbHMuaXNTdXBwb3J0ZWQoKTtcclxuICAgIHRoaXMuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFwiaW5zaWRlIGF0dGFjaCBtZWRpYVwiLCB2cFJlY2VpdmVyLkhMU3N1cHBvcnRlZCk7XHJcbiAgICB0aGlzLnZpZGVvLnBsYXliYWNrUmF0ZSA9IDE7XHJcbiAgICB0aGlzLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhcclxuICAgICAgXCJ2aWRlbyBmaWxlXCIsXHJcbiAgICAgIEpTT04uc3RyaW5naWZ5KHRoaXMudmlkZW8sIFtcImlkXCIsIFwiY2xhc3NOYW1lXCIsIFwidGFnTmFtZVwiXSlcclxuICAgICk7XHJcbiAgICBpZiAodGhpcy52aWRlb09iamVjdC5maWxlLmVuZHNXaXRoKFwibXA0XCIpKSB7XHJcbiAgICAgIHRoaXMuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFwiaW5zaWRlIG1wNFwiLCB0aGlzLnZpZGVvT2JqZWN0LmZpbGUpO1xyXG4gICAgICB0aGlzLnZpZGVvLnNyYyA9IHRoaXMudmlkZW9PYmplY3QuZmlsZTtcclxuICAgICAgdGhpcy5zdGFydCgpO1xyXG4gICAgfSBlbHNlIGlmICh2cFJlY2VpdmVyLkhMU3N1cHBvcnRlZCkge1xyXG4gICAgICB0aGlzLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhcImluc2lkZSBobHNzdXBwb3J0ZWRcIiwgdGhpcy52aWRlb09iamVjdC5maWxlKTtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICB0aGlzLmhscyA9IG5ldyBIbHMoKTtcclxuICAgICAgICB0aGlzLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhcImhscyBpbml0aWFsaXplZFwiLCB0aGlzLnZpZGVvT2JqZWN0LmZpbGUpO1xyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRUaW1lID4gMCkgdGhpcy52aWRlby5jdXJyZW50VGltZSA9IHRoaXMuY3VycmVudFRpbWU7XHJcbiAgICAgICAgdGhpcy5obHMuYXR0YWNoTWVkaWEodGhpcy52aWRlbyk7XHJcbiAgICAgICAgdGhpcy5jYXN0RGVidWdMb2dnZXIuZGVidWcoXCJhdHRhY2hlZCBtZWRpYVwiLCB0aGlzLnZpZGVvT2JqZWN0LmZpbGUpO1xyXG4gICAgICAgIHRoaXMuaGxzLm9uKEhscy5FdmVudHMuTUVESUFfQVRUQUNIRUQsICgpID0+IHtcclxuICAgICAgICAgIHRoaXMuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFwiYW1lZGlhIGF0dGFjaGVkXCIsIHRoaXMudmlkZW9PYmplY3QuZmlsZSk7XHJcbiAgICAgICAgICB0aGlzLmhscy5zdGFydExldmVsID0gMDtcclxuICAgICAgICAgIHRoaXMuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFxyXG4gICAgICAgICAgICBcImxvYWRpbmcgc291cmNlIGhsc3N1cHBvcnRlZFwiLFxyXG4gICAgICAgICAgICB0aGlzLnZpZGVvT2JqZWN0LmZpbGVcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgICB0aGlzLmhscy5sb2FkU291cmNlKHRoaXMudmlkZW9PYmplY3QuZmlsZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5obHMub24oSGxzLkV2ZW50cy5NQU5JRkVTVF9QQVJTRUQsIChldmVudCwgZGF0YSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5zdGFydCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuaGxzLm9uKEhscy5FdmVudHMuRVJST1IsIChldmVudCwgZGF0YSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5jYXN0RGVidWdMb2dnZXIuZGVidWcoXCJITFMgIEVSUk9SXCIsIGRhdGEuZGV0YWlscyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7fVxyXG5cclxuICAgICAgLy8gdGhpcy5obHMub24oSGxzLkV2ZW50cy5FUlJPUiwgKGV2ZW50LCBkYXRhKSA9PiB7XHJcbiAgICAgIC8vICAgaWYgKGRhdGEuZGV0YWlscyA9PT0gXCJtYW5pZmVzdExvYWRFcnJvclwiKSB7XHJcbiAgICAgIC8vICAgICB0aGlzLnZpZGVvQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoY3NzQ2xhc3Nlcy5lZmZlY3RzLmhpZGVDb250ZW50KTtcclxuICAgICAgLy8gICAgIHRoaXMudmlkZW9Db250YWluZXIuY2xhc3NMaXN0LmFkZChjc3NDbGFzc2VzLmVmZmVjdHMuc2hvd0Vycm9yKTtcclxuICAgICAgLy8gICB9XHJcblxyXG4gICAgICAvLyAgIGlmIChkYXRhLmRldGFpbHMgPT09IFwibWFuaWZlc3RMb2FkVGltZU91dFwiKSB7XHJcbiAgICAgIC8vICAgICB0aGlzLnZpZGVvQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoY3NzQ2xhc3Nlcy5lZmZlY3RzLmhpZGVDb250ZW50KTtcclxuICAgICAgLy8gICAgIHRoaXMudmlkZW9Db250YWluZXIuY2xhc3NMaXN0LmFkZChjc3NDbGFzc2VzLmVmZmVjdHMuc2hvd0Vycm9yKTtcclxuICAgICAgLy8gICB9XHJcblxyXG4gICAgICAvLyAgIGlmIChkYXRhLmRldGFpbHMgPT09IFwibWFuaWZlc3RQYXJzaW5nRXJyb3JcIikge1xyXG4gICAgICAvLyAgICAgdGhpcy52aWRlb0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKGNzc0NsYXNzZXMuZWZmZWN0cy5oaWRlQ29udGVudCk7XHJcbiAgICAgIC8vICAgICB0aGlzLnZpZGVvQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoY3NzQ2xhc3Nlcy5lZmZlY3RzLnNob3dFcnJvcik7XHJcbiAgICAgIC8vICAgfVxyXG5cclxuICAgICAgLy8gICBpZiAoZGF0YS5kZXRhaWxzID09PSBcImxldmVsTG9hZEVycm9yXCIpIHtcclxuICAgICAgLy8gICAgIHRoaXMucmVtb3ZlTGV2ZWwoZGF0YS5jb250ZXh0LmxldmVsKTtcclxuICAgICAgLy8gICB9XHJcblxyXG4gICAgICAvLyAgIGlmIChkYXRhLmRldGFpbHMgPT09IFwiZnJhZ0xvYWRFcnJvclwiKSB7XHJcbiAgICAgIC8vICAgICB0aGlzLmZyYWdFcnJvckNvdW50Kys7XHJcbiAgICAgIC8vICAgICAvLyBzbiByZWZlcmVzIHRvIHNlcXVlbmNlIG51bWJlclxyXG4gICAgICAvLyAgICAgaWYgKGRhdGEuZnJhZy5zbiA9PSAwKSB0aGlzLmZhaWxlZFRvTG9hZEZpcnN0RnJhZ21lbnQgPSB0cnVlO1xyXG4gICAgICAvLyAgIH1cclxuXHJcbiAgICAgIC8vICAgaWYgKHRoaXMubGV2ZWxIYXNNaXNzaW5nRnJhZ21lbnRzKCkpIHtcclxuICAgICAgLy8gICAgIHRoaXMuZnJhZ0Vycm9yQ291bnQgPSAwO1xyXG4gICAgICAvLyAgICAgdGhpcy5yZW1vdmVMZXZlbChkYXRhLmZyYWcubGV2ZWwpO1xyXG4gICAgICAvLyAgICAgdGhpcy5obHMubG9hZExldmVsID0gLTE7XHJcbiAgICAgIC8vICAgICBjb25zb2xlLmxvZyhcIk5ldHdvcmsgZXJyb3IgZW5jb3VudGVyZWRcIik7XHJcbiAgICAgIC8vICAgfVxyXG5cclxuICAgICAgLy8gICBpZiAodGhpcy5mYWlsZWRUb0xvYWRGaXJzdEZyYWdtZW50KSB7XHJcbiAgICAgIC8vICAgICB0aGlzLmZhaWxlZFRvTG9hZEZpcnN0RnJhZ21lbnQgPSBmYWxzZTtcclxuICAgICAgLy8gICAgIHRoaXMucmVtb3ZlTGV2ZWwoZGF0YS5mcmFnLmxldmVsKTtcclxuICAgICAgLy8gICAgIHRoaXMuaGxzLmxvYWRMZXZlbCA9IC0xO1xyXG4gICAgICAvLyAgICAgdGhpcy5vblBsYXkoKTtcclxuICAgICAgLy8gICAgIGNvbnNvbGUubG9nKFwiTmV0d29yayBlcnJvciBlbmNvdW50ZXJlZFwiKTtcclxuICAgICAgLy8gICB9XHJcblxyXG4gICAgICAvLyAgIGlmICghZGF0YS5mYXRhbCkge1xyXG4gICAgICAvLyAgICAgcmV0dXJuO1xyXG4gICAgICAvLyAgIH1cclxuXHJcbiAgICAgIC8vICAgc3dpdGNoIChkYXRhLnR5cGUpIHtcclxuICAgICAgLy8gICAgIGNhc2UgSGxzLkVycm9yVHlwZXMuTkVUV09SS19FUlJPUjpcclxuICAgICAgLy8gICAgICAgY29uc29sZS5sb2coXCJmYXRhbCBuZXR3b3JrIGVycm9yIGVuY291bnRlcmVkXCIpO1xyXG4gICAgICAvLyAgICAgICB0aGlzLmhscy5zdGFydExvYWQoKTtcclxuICAgICAgLy8gICAgICAgYnJlYWs7XHJcbiAgICAgIC8vICAgICBjYXNlIEhscy5FcnJvclR5cGVzLk1FRElBX0VSUk9SOlxyXG4gICAgICAvLyAgICAgICBjb25zb2xlLmxvZyhcImZhdGFsIG1lZGlhIGVycm9yIGVuY291bnRlcmVkXCIpO1xyXG4gICAgICAvLyAgICAgICB0aGlzLmhscy5yZWNvdmVyTWVkaWFFcnJvcigpO1xyXG4gICAgICAvLyAgICAgICBicmVhaztcclxuICAgICAgLy8gICAgIGRlZmF1bHQ6XHJcbiAgICAgIC8vICAgICAgIHRoaXMuaGxzLmRlc3Ryb3koKTtcclxuICAgICAgLy8gICAgICAgYnJlYWs7XHJcbiAgICAgIC8vICAgfVxyXG4gICAgICAvLyB9KTtcclxuICAgIH1cclxuICAgIHRoaXMuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFwiZmluaXNoZWQgYXR0YWNoIG1lZGlhXCIpO1xyXG4gICAgLy8gIGVsc2UgaWYgKHRoaXMudmlkZW8uY2FuUGxheVR5cGUoXCJhcHBsaWNhdGlvbi92bmQuYXBwbGUubXBlZ3VybFwiKSkge1xyXG4gICAgLy8gICB0aGlzLnZpZGVvLnNyYyA9IHRoaXMudmlkZW9PYmplY3QuZmlsZTtcclxuICAgIC8vICAgaWYgKFV0aWxzLmlzSU9TKCkpIHtcclxuICAgIC8vICAgICBmcHNfZHJtLmluaXQoXHJcbiAgICAvLyAgICAgICB0aGlzLnZpZGVvLFxyXG4gICAgLy8gICAgICAgY29uZmlnLmZwc0NlcnRpZmljYXRlVXJsLFxyXG4gICAgLy8gICAgICAgdGhpcy52aWRlb09iamVjdC5hc3NldElkXHJcbiAgICAvLyAgICAgKTtcclxuICAgIC8vICAgfVxyXG4gICAgLy8gICB0aGlzLnZpZGVvLnBsYXlzSW5saW5lID0gdHJ1ZTtcclxuICAgIC8vICAgdGhpcy5zdGFydCgpO1xyXG4gICAgLy8gfVxyXG4gIH1cclxuICBmYWtlaW5pdCgpIHtcclxuICAgIHRoaXMuY2FzdERlYnVnTG9nZ2VyID0ge1xyXG4gICAgICBkZWJ1ZzogZnVuY3Rpb24gKHR5cGUsIG1lc3NhZ2UpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyh0eXBlLCBtZXNzYWdlKTtcclxuICAgICAgfSxcclxuICAgICAgZXJyb3I6IGZ1bmN0aW9uICh0eXBlLCBtZXNzYWdlKSB7XHJcbiAgICAgICAgY29uc29sZS5sb2codHlwZSwgbWVzc2FnZSk7XHJcbiAgICAgIH0sXHJcbiAgICB9O1xyXG4gICAgdGhpcy5yZWNlaXZlckNvbnRyb2xzLnNldENhc3REZWJ1Z2dlcih0aGlzLmNhc3REZWJ1Z0xvZ2dlcik7XHJcbiAgICB0aGlzLnZpZGVvT2JqZWN0LmZpbGUgPVxyXG4gICAgICBcImh0dHBzOi8vdnAuZ2ppcmFmYS5uZXQvdnBzL3Byb2Qvb2RnZWh0eW8vZW5jb2RlL3Zqc215bGRzL21wNC8xMDgwcC5tcDRcIjtcclxuICAgIC8vIHRoaXMudmFzdFNlcnZpY2UubG9hZEFkcyhcclxuICAgIC8vICAgXCJodHRwczovL3ZwLWRldi5namlyYWZhLm5ldC92cHMvY29udGVudC92YXN0L3ByZXJvbGwtMi54bWxcIlxyXG4gICAgLy8gKTtcclxuICAgIGlmICghZG9jdW1lbnQuZnVsbHNjcmVlbkVsZW1lbnQpIHtcclxuICAgICAgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnJlcXVlc3RGdWxsc2NyZWVuKCkuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGFsZXJ0KFxyXG4gICAgICAgICAgYEVycm9yIGF0dGVtcHRpbmcgdG8gZW5hYmxlIGZ1bGwtc2NyZWVuIG1vZGU6ICR7XHJcbiAgICAgICAgICAgIGVyci5tZXNzYWdlXHJcbiAgICAgICAgICB9ICgke2Vyci50b1N0cmluZygpfSlgXHJcbiAgICAgICAgKTtcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBkb2N1bWVudC5leGl0RnVsbHNjcmVlbigpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5hdHRhY2hNZWRpYSgpO1xyXG4gICAgdGhpcy5iaW5kTWV0aG9kcygpO1xyXG4gICAgLy8gdGhpcy5iaW5kSW50ZXJjZXB0b3JzKCk7XHJcbiAgICB0aGlzLmFkZFBsYXllckV2ZW50cygpO1xyXG4gIH1cclxuICBpbml0KCkge1xyXG4gICAgdGhpcy5jb250ZXh0ID0gY2FzdC5mcmFtZXdvcmsuQ2FzdFJlY2VpdmVyQ29udGV4dC5nZXRJbnN0YW5jZSgpO1xyXG5cclxuICAgIHRoaXMuY29udGV4dC5zZXRMb2dnZXJMZXZlbChjYXN0LmZyYW1ld29yay5Mb2dnZXJMZXZlbC5ERUJVRyk7XHJcblxyXG4gICAgdGhpcy5jYXN0RGVidWdMb2dnZXIgPSBjYXN0LmRlYnVnLkNhc3REZWJ1Z0xvZ2dlci5nZXRJbnN0YW5jZSgpO1xyXG4gICAgdGhpcy5jYXN0RGVidWdMb2dnZXIuc2V0RW5hYmxlZCh0cnVlKTtcclxuICAgIHRoaXMuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKHRoaXMuZGVidWdUYWdzLklOSVQsIFwiY2FzdGRlYnVnZ2VyIGluaXRpYWxpemVkXCIpO1xyXG4gICAgdGhpcy5wbGF5ZXJNYW5hZ2VyID0gdGhpcy5jb250ZXh0LmdldFBsYXllck1hbmFnZXIoKTtcclxuICAgIHRoaXMucGxheWVyTWFuYWdlci5zZXRNZWRpYUVsZW1lbnQodGhpcy52aWRlbyk7XHJcblxyXG4gICAgdGhpcy5yZWNlaXZlckNvbnRyb2xzLnNldENhc3REZWJ1Z2dlcih0aGlzLmNhc3REZWJ1Z0xvZ2dlcik7XHJcbiAgICAvLyB0aGlzLnBsYXliYWNrQ29uZmlnLmF1dG9SZXN1bWVEdXJhdGlvbiA9IDU7XHJcbiAgICAvLyB0aGlzLmNhc3REZWJ1Z0xvZ2dlci5pbmZvKExPR19SRUNFSVZFUl9UQUcsIGBhdXRvaW5pdDogYCk7XHJcbiAgICAvLyB0aGlzLmNvbnRyb2xzLmNsZWFyRGVmYXVsdFNsb3RBc3NpZ25tZW50cygpO1xyXG4gICAgLy8gdGhpcy5kcmF3QnV0dG9ucygpO1xyXG5cclxuICAgIC8vIGNvbnRleHQuc3RhcnQoe1xyXG4gICAgLy8gICBxdWV1ZTogbmV3IENhc3RRdWV1ZSgpLFxyXG4gICAgLy8gICBwbGF5YmFja0NvbmZpZzogdGhpcy5wbGF5YmFja0NvbmZpZyxcclxuICAgIC8vICAgc3VwcG9ydGVkQ29tbWFuZHM6XHJcbiAgICAvLyAgICAgY2FzdC5mcmFtZXdvcmsubWVzc2FnZXMuQ29tbWFuZC5BTExfQkFTSUNfTUVESUEgfFxyXG4gICAgLy8gICAgIGNhc3QuZnJhbWV3b3JrLm1lc3NhZ2VzLkNvbW1hbmQuUVVFVUVfUFJFViB8XHJcbiAgICAvLyAgICAgY2FzdC5mcmFtZXdvcmsubWVzc2FnZXMuQ29tbWFuZC5RVUVVRV9ORVhUIHxcclxuICAgIC8vICAgICBjYXN0LmZyYW1ld29yay5tZXNzYWdlcy5Db21tYW5kLlNUUkVBTV9UUkFOU0ZFUixcclxuICAgIC8vIH0pO1xyXG4gICAgLy8gdGhpcy5iaW5kSW50ZXJjZXB0b3JzKCk7XHJcbiAgICAvLyB0aGlzLnZpZGVvT2JqZWN0LmZpbGUgPVxyXG4gICAgLy8gICBcImh0dHBzOi8vdnAuZ2ppcmFmYS5uZXQvdnBzL3Byb2Qvb2RnZWh0eW8vZW5jb2RlL3Zqc215bGRzL21wNC8zNjBwLm1wNFwiO1xyXG4gICAgLy8gdGhpcy5hdHRhY2hNZWRpYSgpO1xyXG4gICAgY29uc3Qgb3B0aW9ucyA9IG5ldyBjYXN0LmZyYW1ld29yay5DYXN0UmVjZWl2ZXJPcHRpb25zKCk7XHJcbiAgICAvLyBNYXAgb2YgbmFtZXNwYWNlIG5hbWVzIHRvIHRoZWlyIHR5cGVzLlxyXG4gICAgb3B0aW9ucy5jdXN0b21OYW1lc3BhY2VzID0ge307XHJcbiAgICBvcHRpb25zLmN1c3RvbU5hbWVzcGFjZXNbdGhpcy5OQU1FU1BBQ0VdID1cclxuICAgICAgY2FzdC5mcmFtZXdvcmsuc3lzdGVtLk1lc3NhZ2VUeXBlLkpTT047XHJcbiAgICB0aGlzLmNvbnRleHQuc3RhcnQob3B0aW9ucyk7XHJcbiAgICB0aGlzLmJpbmRNZXRob2RzKCk7XHJcbiAgICB0aGlzLmJpbmRJbnRlcmNlcHRvcnMoKTtcclxuICAgIHRoaXMuYWRkUGxheWVyRXZlbnRzKCk7XHJcbiAgfVxyXG4gIG9uU2VlayhyZXF1ZXN0RGF0YSkge1xyXG4gICAgdGhpcy52aWRlby5jdXJyZW50VGltZSA9IHJlcXVlc3REYXRhLmN1cnJlbnRUaW1lO1xyXG4gICAgdGhpcy5yZWNlaXZlckNvbnRyb2xzLnNob3dDb250cm9scygpO1xyXG4gICAgdGhpcy5yZWNlaXZlckNvbnRyb2xzLmhpZGVDb250cm9scyg2MDAwKTtcclxuXHJcbiAgICB0aGlzLnJlY2VpdmVyQ29udHJvbHMudXBkYXRlKHRoaXMudXBkYXRlUGxheWVyU3RhdGUoKSk7XHJcbiAgfVxyXG4gIGRyYXdCdXR0b25zKCkge1xyXG4gICAgdGhpcy5jb250cm9scy5hc3NpZ25CdXR0b24oXHJcbiAgICAgIGNhc3QuZnJhbWV3b3JrLnVpLkNvbnRyb2xzU2xvdC5TTE9UX1NFQ09OREFSWV8xLFxyXG4gICAgICBjYXN0LmZyYW1ld29yay51aS5Db250cm9sc0J1dHRvbi5RVUVVRV9QUkVWXHJcbiAgICApO1xyXG4gICAgdGhpcy5jb250cm9scy5hc3NpZ25CdXR0b24oXHJcbiAgICAgIGNhc3QuZnJhbWV3b3JrLnVpLkNvbnRyb2xzU2xvdC5TTE9UX1BSSU1BUllfMSxcclxuICAgICAgY2FzdC5mcmFtZXdvcmsudWkuQ29udHJvbHNCdXR0b24uQ0FQVElPTlNcclxuICAgICk7XHJcbiAgICB0aGlzLmNvbnRyb2xzLmFzc2lnbkJ1dHRvbihcclxuICAgICAgY2FzdC5mcmFtZXdvcmsudWkuQ29udHJvbHNTbG90LlNMT1RfUFJJTUFSWV8yLFxyXG4gICAgICBjYXN0LmZyYW1ld29yay51aS5Db250cm9sc0J1dHRvbi5TRUVLX0ZPUldBUkRfMTVcclxuICAgICk7XHJcbiAgICB0aGlzLmNvbnRyb2xzLmFzc2lnbkJ1dHRvbihcclxuICAgICAgY2FzdC5mcmFtZXdvcmsudWkuQ29udHJvbHNTbG90LlNMT1RfU0VDT05EQVJZXzIsXHJcbiAgICAgIGNhc3QuZnJhbWV3b3JrLnVpLkNvbnRyb2xzQnV0dG9uLlFVRVVFX05FWFRcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBiaW5kSW50ZXJjZXB0b3JzKCkge1xyXG4gICAgdGhpcy5jb250ZXh0LmFkZEV2ZW50TGlzdGVuZXIoXHJcbiAgICAgIGNhc3QuZnJhbWV3b3JrLnN5c3RlbS5FdmVudFR5cGUuU0VOREVSX0RJU0NPTk5FQ1RFRCxcclxuICAgICAgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgd2luZG93LmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgICAvLyB0aGlzLmNvbnRleHQuYWRkQ3VzdG9tTWVzc2FnZUxpc3RlbmVyKE5BTUVTUEFDRSwgKGV2ZW50KSA9PiB7XHJcbiAgICAvLyAgIHRoaXMuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFxyXG4gICAgLy8gICAgIHRoaXMuZGVidWdUYWdzLkVWRU5UUyxcclxuICAgIC8vICAgICBcImFkZEN1c3RvbU1lc3NhZ2VMaXN0ZW5lclwiICsgZXZlbnQuZGF0YVxyXG4gICAgLy8gICApO1xyXG4gICAgLy8gfSk7XHJcbiAgICB0aGlzLnBsYXllck1hbmFnZXIuc2V0TWVzc2FnZUludGVyY2VwdG9yKFxyXG4gICAgICBjYXN0LmZyYW1ld29yay5tZXNzYWdlcy5NZXNzYWdlVHlwZS5MT0FELFxyXG4gICAgICB0aGlzLm9uTG9hZFJlcXVlc3QuYmluZCh0aGlzKVxyXG4gICAgKTtcclxuICAgIHRoaXMucGxheWVyTWFuYWdlci5zZXRNZXNzYWdlSW50ZXJjZXB0b3IoXHJcbiAgICAgIGNhc3QuZnJhbWV3b3JrLm1lc3NhZ2VzLk1lc3NhZ2VUeXBlLlBMQVksXHJcbiAgICAgIHRoaXMub25QbGF5LmJpbmQodGhpcylcclxuICAgICk7XHJcbiAgICB0aGlzLnBsYXllck1hbmFnZXIuc2V0TWVzc2FnZUludGVyY2VwdG9yKFxyXG4gICAgICBjYXN0LmZyYW1ld29yay5tZXNzYWdlcy5NZXNzYWdlVHlwZS5QQVVTRSxcclxuICAgICAgdGhpcy5vblBhdXNlLmJpbmQodGhpcylcclxuICAgICk7XHJcbiAgICB0aGlzLnBsYXllck1hbmFnZXIuc2V0TWVzc2FnZUludGVyY2VwdG9yKFxyXG4gICAgICBjYXN0LmZyYW1ld29yay5tZXNzYWdlcy5NZXNzYWdlVHlwZS5TRUVLLFxyXG4gICAgICB0aGlzLm9uU2Vlay5iaW5kKHRoaXMpXHJcbiAgICApO1xyXG4gIH1cclxuICBiaW5kTWV0aG9kcygpIHtcclxuICAgIHRoaXMuYmluZEludGVyY2VwdG9ycyA9IHRoaXMuYmluZEludGVyY2VwdG9ycy5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5vbkxvYWRSZXF1ZXN0ID0gdGhpcy5vbkxvYWRSZXF1ZXN0LmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLmF0dGFjaE1lZGlhID0gdGhpcy5hdHRhY2hNZWRpYS5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5zdGFydCA9IHRoaXMuc3RhcnQuYmluZCh0aGlzKTtcclxuICAgIHRoaXMuYWRkUGxheWVyRXZlbnRzID0gdGhpcy5hZGRQbGF5ZXJFdmVudHMuYmluZCh0aGlzKTtcclxuICAgIHRoaXMub25UaW1lVXBkYXRlID0gdGhpcy5vblRpbWVVcGRhdGUuYmluZCh0aGlzKTtcclxuICAgIHRoaXMub25QbGF5ID0gdGhpcy5vblBsYXkuYmluZCh0aGlzKTtcclxuICAgIHRoaXMub25QYXVzZSA9IHRoaXMub25QYXVzZS5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy51cGRhdGVQbGF5ZXJTdGF0ZSA9IHRoaXMudXBkYXRlUGxheWVyU3RhdGUuYmluZCh0aGlzKTtcclxuICAgIHRoaXMub25FbmQgPSB0aGlzLm9uRW5kLmJpbmQodGhpcyk7XHJcbiAgfVxyXG4gIG9uTG9hZFJlcXVlc3QobG9hZFJlcXVlc3REYXRhKSB7XHJcbiAgICAvLyBJZiB0aGUgbG9hZFJlcXVlc3REYXRhIGlzIGluY29tcGxldGUgcmV0dXJuIGFuIGVycm9yIG1lc3NhZ2VcclxuICAgIC8vIGlmICghbG9hZFJlcXVlc3REYXRhIHx8ICFsb2FkUmVxdWVzdERhdGEubWVkaWEpIHtcclxuICAgIC8vICAgY29uc3QgZXJyb3IgPSBuZXcgY2FzdC5mcmFtZXdvcmsubWVzc2FnZXMuRXJyb3JEYXRhKFxyXG4gICAgLy8gICAgIGNhc3QuZnJhbWV3b3JrLm1lc3NhZ2VzLkVycm9yVHlwZS5MT0FEX0ZBSUxFRFxyXG4gICAgLy8gICApO1xyXG4gICAgLy8gICBlcnJvci5yZWFzb24gPSBjYXN0LmZyYW1ld29yay5tZXNzYWdlcy5FcnJvclJlYXNvbi5JTlZBTElEX1JFUVVFU1Q7XHJcbiAgICAvLyAgIHJldHVybiBlcnJvcjtcclxuICAgIC8vIH1cclxuXHJcbiAgICAvLyAvLyBjaGVjayBhbGwgY29udGVudCBzb3VyY2UgZmllbGRzIGZvciBhc3NldCBVUkwgb3IgSURcclxuICAgIC8vIGxldCBzb3VyY2UgPVxyXG4gICAgLy8gICBsb2FkUmVxdWVzdERhdGEubWVkaWEuY29udGVudFVybCB8fFxyXG4gICAgLy8gICBsb2FkUmVxdWVzdERhdGEubWVkaWEuZW50aXR5IHx8XHJcbiAgICAvLyAgIGxvYWRSZXF1ZXN0RGF0YS5tZWRpYS5jb250ZW50SWQ7XHJcbiAgICB0aGlzLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhcIlZQcmVjZWl2ZXJcIiwgbG9hZFJlcXVlc3REYXRhLm1lZGlhLmNvbnRlbnRJZCk7XHJcbiAgICB0aGlzLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhcIlZQcmVjZWl2ZXIxXCIsIEhscy5pc1N1cHBvcnRlZCgpKTtcclxuICAgIHRoaXMudmlkZW9PYmplY3QuZmlsZSA9IGxvYWRSZXF1ZXN0RGF0YS5tZWRpYS5jb250ZW50SWQ7XHJcbiAgICB0aGlzLnZpZGVvT2JqZWN0LmR1cmF0aW9uID0gbG9hZFJlcXVlc3REYXRhLm1lZGlhLm1ldGFkYXRhLmR1cmF0aW9uO1xyXG4gICAgdGhpcy5jdXJyZW50VGltZSA9IGxvYWRSZXF1ZXN0RGF0YS5jdXJyZW50VGltZTtcclxuICAgIHRoaXMucGxheWJhY2tSYXRlID0gbG9hZFJlcXVlc3REYXRhLnBsYXliYWNrUmF0ZTtcclxuICAgIHRoaXMuYXV0b3BsYXkgPSBsb2FkUmVxdWVzdERhdGEuYXV0b3BsYXk7XHJcbiAgICAvLyB0cnkge1xyXG4gICAgdGhpcy5jb25maWcucmVwbGF5ID1cclxuICAgICAgdHlwZW9mIGxvYWRSZXF1ZXN0RGF0YS5yZXBsYXkgIT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgICA/IGxvYWRSZXF1ZXN0RGF0YS5yZXBsYXlcclxuICAgICAgICA6IHRydWU7XHJcbiAgICB0cnkge1xyXG4gICAgICBpZiAoXHJcbiAgICAgICAgbG9hZFJlcXVlc3REYXRhLmN1c3RvbURhdGEudmFzdFVybCB8fFxyXG4gICAgICAgIGxvYWRSZXF1ZXN0RGF0YS5jdXN0b21EYXRhLnZhc3RYbWxcclxuICAgICAgKSB7XHJcbiAgICAgICAgLy8gdGhpcy5wbGF5ZXJNYW5hZ2VyLnNldE1lZGlhRWxlbWVudCh0aGlzLnZpZGVvKTtcclxuICAgICAgICB0aGlzLmJyb2FkY2FzdCh7XHJcbiAgICAgICAgICBtZXNzYWdlOiBcInBsYXlpbmcgYWRcIixcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLnZhc3RTZXJ2aWNlLmxvYWRBZHMoXHJcbiAgICAgICAgICBsb2FkUmVxdWVzdERhdGEuY3VzdG9tRGF0YS52YXN0VXJsLFxyXG4gICAgICAgICAgbG9hZFJlcXVlc3REYXRhLmN1c3RvbURhdGEudmFzdFhtbFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgdGhpcy5icm9hZGNhc3Qoe1xyXG4gICAgICAgICAgbWVzc2FnZTogXCJhZCBsb2FkaW5nIGZpbmlzaGVkXCIsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5jYXN0RGVidWdMb2dnZXIuZGVidWcoXHJcbiAgICAgICAgICB0aGlzLmRlYnVnVGFncy5MT0FEX1JFUVVFU1QsXHJcbiAgICAgICAgICBcIkxvYWRpbmcgYWQgZmluaXNoZWRcIlxyXG4gICAgICAgICk7XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5hdHRhY2hNZWRpYSgpO1xyXG4gICAgICAgIHRoaXMuYnJvYWRjYXN0KHtcclxuICAgICAgICAgIG1lc3NhZ2U6IFwiYXR0YWNoaW5nIG1lZGlhXCIsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIHRoaXMuYnJvYWRjYXN0KHtcclxuICAgICAgICBtZXNzYWdlOiBlcnJvci50b1N0cmluZygpLFxyXG4gICAgICAgIHN0YWNrOiBlcnJvci5zdGFjayxcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICAgIC8vIElmIHRoZXJlIGlzIG5vIHNvdXJjZSBvciBhIG1hbGZvcm1lZCBJRCB0aGVuIHJldHVybiBhbiBlcnJvci5cclxuICAgIGlmICghc291cmNlIHx8IHNvdXJjZSA9PSBcIlwiIHx8ICFzb3VyY2UubWF0Y2goSURfUkVHRVgpKSB7XHJcbiAgICAgIGxldCBlcnJvciA9IG5ldyBjYXN0LmZyYW1ld29yay5tZXNzYWdlcy5FcnJvckRhdGEoXHJcbiAgICAgICAgY2FzdC5mcmFtZXdvcmsubWVzc2FnZXMuRXJyb3JUeXBlLkxPQURfRkFJTEVEXHJcbiAgICAgICk7XHJcbiAgICAgIGVycm9yLnJlYXNvbiA9IGNhc3QuZnJhbWV3b3JrLm1lc3NhZ2VzLkVycm9yUmVhc29uLklOVkFMSURfUkVRVUVTVDtcclxuICAgICAgcmV0dXJuIGVycm9yO1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBzb3VyY2VJZCA9IHNvdXJjZS5tYXRjaChJRF9SRUdFWClbMV07XHJcblxyXG4gICAgLy8gQWRkIGJyZWFrcyB0byB0aGUgbWVkaWEgaW5mb3JtYXRpb24gYW5kIHNldCB0aGUgY29udGVudFVybFxyXG4gICAgcmV0dXJuIGFkZEJyZWFrcyhsb2FkUmVxdWVzdERhdGEubWVkaWEpXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAvLyBJZiB0aGUgc291cmNlIGlzIGEgdXJsIHRoYXQgcG9pbnRzIHRvIGFuIGFzc2V0IGRvbid0IGZldGNoIGZyb20gYmFja2VuZFxyXG4gICAgICAgIGlmIChzb3VyY2VJZC5pbmNsdWRlcyhcIi5cIikpIHtcclxuICAgICAgICAgIGNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhcclxuICAgICAgICAgICAgTE9HX1JFQ0VJVkVSX1RBRyxcclxuICAgICAgICAgICAgXCJJbnRlcmNlcHRvciByZWNlaXZlZCBmdWxsIFVSTFwiXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgICAgbG9hZFJlcXVlc3REYXRhLm1lZGlhLmNvbnRlbnRVcmwgPSBzb3VyY2U7XHJcbiAgICAgICAgICByZXR1cm4gbG9hZFJlcXVlc3REYXRhO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gRmV0Y2ggdGhlIGNvbnRlbnRVcmwgaWYgcHJvdmlkZWQgYW4gSUQgb3IgZW50aXR5IFVSTFxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgY2FzdERlYnVnTG9nZ2VyLmRlYnVnKExPR19SRUNFSVZFUl9UQUcsIFwiSW50ZXJjZXB0b3IgcmVjZWl2ZWQgSURcIik7XHJcbiAgICAgICAgICByZXR1cm4gdGhpcy5mZXRjaE1lZGlhQnlJZChzb3VyY2VJZCkudGhlbigoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICBsZXQgbWV0YWRhdGEgPSBuZXcgY2FzdC5mcmFtZXdvcmsubWVzc2FnZXMuR2VuZXJpY01lZGlhTWV0YWRhdGEoKTtcclxuICAgICAgICAgICAgbWV0YWRhdGEudGl0bGUgPSBpdGVtLnRpdGxlO1xyXG4gICAgICAgICAgICBtZXRhZGF0YS5zdWJ0aXRsZSA9IGl0ZW0uZGVzY3JpcHRpb247XHJcbiAgICAgICAgICAgIGxvYWRSZXF1ZXN0RGF0YS5tZWRpYS5jb250ZW50SWQgPSBpdGVtLnN0cmVhbS5kYXNoO1xyXG4gICAgICAgICAgICBsb2FkUmVxdWVzdERhdGEubWVkaWEuY29udGVudFR5cGUgPSBcImFwcGxpY2F0aW9uL2Rhc2greG1sXCI7XHJcbiAgICAgICAgICAgIGxvYWRSZXF1ZXN0RGF0YS5tZWRpYS5tZXRhZGF0YSA9IG1ldGFkYXRhO1xyXG4gICAgICAgICAgICByZXR1cm4gbG9hZFJlcXVlc3REYXRhO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yTWVzc2FnZSkgPT4ge1xyXG4gICAgICAgIGxldCBlcnJvciA9IG5ldyBjYXN0LmZyYW1ld29yay5tZXNzYWdlcy5FcnJvckRhdGEoXHJcbiAgICAgICAgICBjYXN0LmZyYW1ld29yay5tZXNzYWdlcy5FcnJvclR5cGUuTE9BRF9GQUlMRURcclxuICAgICAgICApO1xyXG4gICAgICAgIGVycm9yLnJlYXNvbiA9IGNhc3QuZnJhbWV3b3JrLm1lc3NhZ2VzLkVycm9yUmVhc29uLklOVkFMSURfUkVRVUVTVDtcclxuICAgICAgICBjYXN0RGVidWdMb2dnZXIuZXJyb3IoTE9HX1JFQ0VJVkVSX1RBRywgZXJyb3JNZXNzYWdlKTtcclxuICAgICAgICByZXR1cm4gZXJyb3I7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuICBhZGRCcmVha3MobWVkaWFJbmZvcm1hdGlvbikge1xyXG4gICAgY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFxyXG4gICAgICBMT0dfUkVDRUlWRVJfVEFHLFxyXG4gICAgICBcImFkZEJyZWFrczogXCIgKyBKU09OLnN0cmluZ2lmeShtZWRpYUluZm9ybWF0aW9uKVxyXG4gICAgKTtcclxuICAgIHJldHVybiBmZXRjaE1lZGlhQnlJZChcImZiYl9hZFwiKS50aGVuKChjbGlwMSkgPT4ge1xyXG4gICAgICBtZWRpYUluZm9ybWF0aW9uLmJyZWFrQ2xpcHMgPSBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgaWQ6IFwiZmJiX2FkXCIsXHJcbiAgICAgICAgICB0aXRsZTogY2xpcDEudGl0bGUsXHJcbiAgICAgICAgICBjb250ZW50VXJsOiBjbGlwMS5zdHJlYW0uZGFzaCxcclxuICAgICAgICAgIGNvbnRlbnRUeXBlOiBcImFwcGxpY2F0aW9uL2Rhc2greG1sXCIsXHJcbiAgICAgICAgICB3aGVuU2tpcHBhYmxlOiA1LFxyXG4gICAgICAgIH0sXHJcbiAgICAgIF07XHJcblxyXG4gICAgICBtZWRpYUluZm9ybWF0aW9uLmJyZWFrcyA9IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICBpZDogXCJwcmUtcm9sbFwiLFxyXG4gICAgICAgICAgYnJlYWtDbGlwSWRzOiBbXCJmYmJfYWRcIl0sXHJcbiAgICAgICAgICBwb3NpdGlvbjogMCxcclxuICAgICAgICB9LFxyXG4gICAgICBdO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIGZldGNoTWVkaWFCeUlkKGlkKSB7XHJcbiAgICBjYXN0RGVidWdMb2dnZXIuZGVidWcoTE9HX1JFQ0VJVkVSX1RBRywgXCJmZXRjaGluZyBpZDogXCIgKyBpZCk7XHJcblxyXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChhY2NlcHQsIHJlamVjdCkgPT4ge1xyXG4gICAgICBmZXRjaChDT05URU5UX1VSTClcclxuICAgICAgICAudGhlbigocmVzcG9uc2UpID0+IHJlc3BvbnNlLmpzb24oKSlcclxuICAgICAgICAudGhlbigob2JqKSA9PiB7XHJcbiAgICAgICAgICBpZiAob2JqKSB7XHJcbiAgICAgICAgICAgIGlmIChvYmpbaWRdKSB7XHJcbiAgICAgICAgICAgICAgYWNjZXB0KG9ialtpZF0pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgIHJlamVjdChgJHtpZH0gbm90IGZvdW5kIGluIHJlcG9zaXRvcnlgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgcmVqZWN0KFwiQ29udGVudCByZXBvc2l0b3J5IG5vdCBmb3VuZC5cIik7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IFJlY2VpdmVyO1xyXG4iLCJpbXBvcnQgU2Vla0JhciBmcm9tIFwiLi9zZWVrYmFyXCI7XHJcbmltcG9ydCBUaW1lciBmcm9tIFwiLi90aW1lclwiO1xyXG5jbGFzcyBSZWNlaXZlckNvbnRyb2xzIHtcclxuICBjb25zdHJ1Y3RvcihpZCkge1xyXG4gICAgdGhpcy5zZWVrYmFyID0gbmV3IFNlZWtCYXIoXCIuc2Vla2Jhci1wcm9ncmVzc1wiKTtcclxuICAgIHRoaXMudGltZXIgPSBuZXcgVGltZXIoXCIudGltZXJcIik7XHJcbiAgICB0aGlzLmNhc3REZWJ1Z2dlciA9IG51bGw7XHJcbiAgICB0aGlzLmVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGlkKTtcclxuICAgIHRoaXMuc2hvdyA9IHRydWU7XHJcbiAgICB0aGlzLmxvYWRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubG9hZGVyXCIpO1xyXG4gICAgdGhpcy5wbGF5SWNvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIudnAtaWNvbi1wbGF5XCIpO1xyXG4gICAgdGhpcy5wYXVzZUljb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnZwLWljb24tcGF1c2VcIik7XHJcbiAgfVxyXG4gIHNldENhc3REZWJ1Z2dlcihjYXN0RGVidWdnZXIpIHtcclxuICAgIHRoaXMuY2FzdERlYnVnZ2VyID0gY2FzdERlYnVnZ2VyO1xyXG4gICAgdGhpcy5zZWVrYmFyLnNldENhc3REZWJ1Z2dlcih0aGlzLmNhc3REZWJ1Z2dlcik7XHJcbiAgfVxyXG4gIHBhdXNlKCkge1xyXG4gICAgdGhpcy5wYXVzZUljb24uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgdGhpcy5wbGF5SWNvbi5zdHlsZS5kaXNwbGF5ID0gXCJibG9ja1wiO1xyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIHRoaXMucGxheUljb24uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgfSwgMjAwMCk7XHJcbiAgfVxyXG4gIHBsYXkoKSB7XHJcbiAgICB0aGlzLnBsYXlJY29uLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgIHRoaXMucGF1c2VJY29uLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XHJcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgdGhpcy5wYXVzZUljb24uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgfSwgMjAwMCk7XHJcbiAgfVxyXG4gIHVwZGF0ZShzdGF0ZSkge1xyXG4gICAgdGhpcy5zZWVrYmFyLnNldFByb2dyZXNzKHN0YXRlLmN1cnJlbnRUaW1lLCBzdGF0ZS5kdXJhdGlvbik7XHJcbiAgICB0aGlzLnRpbWVyLnVwZGF0ZShzdGF0ZS5jdXJyZW50VGltZSwgc3RhdGUuZHVyYXRpb24pO1xyXG4gIH1cclxuICBoaWRlQ29udHJvbHModGltZSkge1xyXG4gICAgdGhpcy5zaG93ID0gZmFsc2U7XHJcbiAgICB0aGlzLnNob3dIaWRlKHRpbWUgfHwgNTAwMCk7XHJcbiAgfVxyXG4gIHNob3dDb250cm9scygpIHtcclxuICAgIHRoaXMuc2hvdyA9IHRydWU7XHJcbiAgICB0aGlzLnNob3dIaWRlKDEwKTtcclxuICB9XHJcbiAgc2hvd0hpZGUodGltaW5nKSB7XHJcbiAgICAvLyB0aGlzLmNhc3RkZWJ1Z2dlci5kZWJ1ZyhcInNob3dIaWRlXCIsIGAke3RpbWluZ30gJHt0aGlzLnNob3d9YCk7XHJcbiAgICBpZiAodGhpcy5zaG93KSB7XHJcbiAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gXCJmbGV4XCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICB9LCB0aW1pbmcpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUmVjZWl2ZXJDb250cm9scztcclxuIiwiaW1wb3J0IFV0aWxzIGZyb20gXCIuLi9oZWxwZXJzL1V0aWxzXCI7XHJcblxyXG5jbGFzcyBUaW1lciB7XHJcbiAgY29uc3RydWN0b3IoaWQpIHtcclxuICAgIHRoaXMuZWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoaWQpO1xyXG4gICAgdGhpcy5lbGVtZW50LnRleHRDb250ZW50ID0gXCIwMDowMCAvIDAwOjAwXCI7XHJcbiAgfVxyXG4gIHVwZGF0ZShjdXJyZW50VGltZSwgZHVyYXRpb24pIHtcclxuICAgIHRoaXMuZWxlbWVudC50ZXh0Q29udGVudCA9IGAke1V0aWxzLmZvcm1hdFRpbWUoXHJcbiAgICAgIGN1cnJlbnRUaW1lXHJcbiAgICApfSAvJHtVdGlscy5mb3JtYXRUaW1lKGR1cmF0aW9uKX1gO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgVGltZXI7XHJcbiJdLCJuYW1lcyI6WyJ0aW1lIiwiaG91cnMiLCJNYXRoIiwiZmxvb3IiLCJtaW51dGVzIiwic2Vjb25kcyIsInRvU3RyaW5nIiwicGFkU3RhcnQiLCJWYXN0U2VydmljZSIsImNvbnN0cnVjdG9yIiwicmVjZWl2ZXIiLCJ0aGlzIiwiYWRDb250YWluZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJhZHNEaXNwbGF5Q29udGFpbmVyIiwiYWRzTG9hZGVyIiwiYWRzRGlzcGxheUluaXRpYWxpemVkIiwiY3VycmVudEFkcyIsImluaXRpYWxpemVkIiwiYXV0b3BsYXlBbGxvd2VkIiwiYXV0b3BsYXlSZXF1aXJlc011dGVkIiwiaGFzRXJyb3JzIiwiaW5pdCIsImdvb2dsZSIsImltYSIsInNldHRpbmdzIiwic2V0VnBhaWRNb2RlIiwiSW1hU2RrU2V0dGluZ3MiLCJWcGFpZE1vZGUiLCJFTkFCTEVEIiwiQWREaXNwbGF5Q29udGFpbmVyIiwidmlkZW8iLCJBZHNMb2FkZXIiLCJnZXRTZXR0aW5ncyIsInNldFBsYXllclR5cGUiLCJhZGRFdmVudExpc3RlbmVyIiwiQWRzTWFuYWdlckxvYWRlZEV2ZW50IiwiVHlwZSIsIkFEU19NQU5BR0VSX0xPQURFRCIsIm9uQWRzTWFuYWdlckxvYWRlZCIsImJpbmQiLCJBZEVycm9yRXZlbnQiLCJBRF9FUlJPUiIsIm9uQWRFcnJvciIsIm9uQWxsQWRzQ29tcGxldGVkIiwiZSIsImNhc3REZWJ1Z0xvZ2dlciIsImRlYnVnIiwiREVCVUdfVkFTVF9TRVJWSUNFIiwib25BZENvbXBsZXRlZCIsImFkc01hbmFnZXIiLCJkZXN0cm95IiwiaXNBZFBsYXlpbmciLCJvbkVuZCIsIm9uQ29udGVudFBhdXNlUmVxdWVzdGVkIiwib25Db250ZW50UmVzdW1lUmVxdWVzdGVkIiwib25BZExvYWRlZCIsImxvYWRBZHMiLCJ2YXN0VXJsIiwidmFzdFhtbCIsImNvbnRlbnQiLCJ0eXBlIiwiY3VycmVudEFkSW5kZXgiLCJsb2FkIiwiYWRzUmVxdWVzdCIsIkFkc1JlcXVlc3QiLCJhZFRhZ1VybCIsImFkc1Jlc3BvbnNlIiwibGluZWFyQWRTbG90V2lkdGgiLCJjbGllbnRXaWR0aCIsImxpbmVhckFkU2xvdEhlaWdodCIsImNsaWVudEhlaWdodCIsIm5vbkxpbmVhckFkU2xvdFdpZHRoIiwibm9uTGluZWFyQWRTbG90SGVpZ2h0Iiwic2V0QWRXaWxsQXV0b1BsYXkiLCJzZXRBZFdpbGxQbGF5TXV0ZWQiLCJ2YXN0TG9hZFRpbWVvdXQiLCJyZXF1ZXN0QWRzIiwib25UaW1lVXBkYXRlIiwib25BZFNraXAiLCJvbkFkU3RhcnRlZCIsImFkc01hbmFnZXJMb2FkZWRFdmVudCIsImFkc1JlbmRlcmluZ1NldHRpbmdzIiwiQWRzUmVuZGVyaW5nU2V0dGluZ3MiLCJnZXRBZHNNYW5hZ2VyIiwiQWRFdmVudCIsIkNPTlRFTlRfUEFVU0VfUkVRVUVTVEVEIiwiQ09OVEVOVF9SRVNVTUVfUkVRVUVTVEVEIiwiQUxMX0FEU19DT01QTEVURUQiLCJMT0FERUQiLCJTVEFSVEVEIiwiQ09NUExFVEUiLCJTS0lQUEVEIiwiQURfUFJPR1JFU1MiLCJBRF9CVUZGRVJJTkciLCJsb2FkaW5nIiwiU0tJUFBBQkxFX1NUQVRFX0NIQU5HRUQiLCJVdGlscyIsImZpcmUiLCJFdmVudHMiLCJhZEV2ZW50cyIsIkFEX1NLSVBQQUJMRSIsImN1cnJlbnRUaW1lIiwicGxheWVyIiwiYWRQbGF5SWQiLCJnZXRDdXJyZW50QWQiLCJnZXRBZElkIiwicGxheUFkcyIsImluaXRpYWxpemUiLCJ3aWR0aCIsImhlaWdodCIsIlZpZXdNb2RlIiwiRlVMTFNDUkVFTiIsInN0YXJ0IiwicmVjZWl2ZXJDb250cm9scyIsImxvYWRlciIsInN0eWxlIiwiZGlzcGxheSIsImFkRXJyb3IiLCJnZXRNZXNzYWdlIiwicmVzdW1lIiwicGF1c2UiLCJ2cFJlY2VpdmVyIiwiaWQiLCJjb25maWciLCJjb250ZXh0IiwicGxheWVyTWFuYWdlciIsImFwcElkIiwicGxheWJhY2tDb25maWciLCJjb250cm9scyIsImhscyIsInZpZGVvT2JqZWN0IiwidmlkZW9Db250YWluZXIiLCJwYXJlbnRFbGVtZW50IiwicGxheWJhY2tSYXRlIiwiYXV0b3BsYXkiLCJzZWVrYmFyIiwiZWxlbWVudCIsImNhc3RkZWJ1Z2dlciIsInNob3ciLCJzZXRDYXN0RGVidWdnZXIiLCJzZXRQcm9ncmVzcyIsImR1cmF0aW9uIiwic2hvd0hpZGUiLCJ0aW1pbmciLCJzZXRUaW1lb3V0IiwidGltZXIiLCJ0ZXh0Q29udGVudCIsInVwZGF0ZSIsImNhc3REZWJ1Z2dlciIsInBsYXlJY29uIiwicGF1c2VJY29uIiwicGxheSIsInN0YXRlIiwiaGlkZUNvbnRyb2xzIiwic2hvd0NvbnRyb2xzIiwibWVkaWFNYW5hZ2VyIiwiY2FzdFJlY2VpdmVyTWFuYWdlciIsInZpZGVvU3RhcnRlZCIsInZhc3RTZXJ2aWNlIiwiZGVidWdUYWdzIiwiTE9BRF9SRVFVRVNUIiwiQVRUQUNIX01FRElBIiwiT05QTEFZIiwiU1RBUlQiLCJJTklUIiwiRVZFTlRTIiwiT05FTkQiLCJCUk9BRENBU1QiLCJOQU1FU1BBQ0UiLCJvblBsYXkiLCJnZXRBdHRyaWJ1dGUiLCJ0aGVuIiwiY2F0Y2giLCJvblBhdXNlIiwiYWRkUGxheWVyRXZlbnRzIiwiYnJvYWRjYXN0IiwibWVzc2FnZSIsInNlbmRDdXN0b21NZXNzYWdlIiwidW5kZWZpbmVkIiwicmVwbGF5IiwiY29kZSIsImVycm9yIiwidXBkYXRlUGxheWVyU3RhdGUiLCJhdHRhY2hNZWRpYSIsIkhMU3N1cHBvcnRlZCIsIkhscyIsImlzU3VwcG9ydGVkIiwiSlNPTiIsInN0cmluZ2lmeSIsImZpbGUiLCJlbmRzV2l0aCIsInNyYyIsIm9uIiwiTUVESUFfQVRUQUNIRUQiLCJzdGFydExldmVsIiwibG9hZFNvdXJjZSIsIk1BTklGRVNUX1BBUlNFRCIsImV2ZW50IiwiZGF0YSIsIkVSUk9SIiwiZGV0YWlscyIsImZha2Vpbml0IiwiY29uc29sZSIsImxvZyIsImZ1bGxzY3JlZW5FbGVtZW50IiwiZXhpdEZ1bGxzY3JlZW4iLCJkb2N1bWVudEVsZW1lbnQiLCJyZXF1ZXN0RnVsbHNjcmVlbiIsImVyciIsImFsZXJ0IiwiYmluZE1ldGhvZHMiLCJjYXN0IiwiZnJhbWV3b3JrIiwiQ2FzdFJlY2VpdmVyQ29udGV4dCIsImdldEluc3RhbmNlIiwic2V0TG9nZ2VyTGV2ZWwiLCJMb2dnZXJMZXZlbCIsIkRFQlVHIiwiQ2FzdERlYnVnTG9nZ2VyIiwic2V0RW5hYmxlZCIsImdldFBsYXllck1hbmFnZXIiLCJzZXRNZWRpYUVsZW1lbnQiLCJvcHRpb25zIiwiQ2FzdFJlY2VpdmVyT3B0aW9ucyIsImN1c3RvbU5hbWVzcGFjZXMiLCJzeXN0ZW0iLCJNZXNzYWdlVHlwZSIsImJpbmRJbnRlcmNlcHRvcnMiLCJvblNlZWsiLCJyZXF1ZXN0RGF0YSIsImRyYXdCdXR0b25zIiwiYXNzaWduQnV0dG9uIiwidWkiLCJDb250cm9sc1Nsb3QiLCJTTE9UX1NFQ09OREFSWV8xIiwiQ29udHJvbHNCdXR0b24iLCJRVUVVRV9QUkVWIiwiU0xPVF9QUklNQVJZXzEiLCJDQVBUSU9OUyIsIlNMT1RfUFJJTUFSWV8yIiwiU0VFS19GT1JXQVJEXzE1IiwiU0xPVF9TRUNPTkRBUllfMiIsIlFVRVVFX05FWFQiLCJFdmVudFR5cGUiLCJTRU5ERVJfRElTQ09OTkVDVEVEIiwid2luZG93IiwiY2xvc2UiLCJzZXRNZXNzYWdlSW50ZXJjZXB0b3IiLCJtZXNzYWdlcyIsIkxPQUQiLCJvbkxvYWRSZXF1ZXN0IiwiUExBWSIsIlBBVVNFIiwiU0VFSyIsImxvYWRSZXF1ZXN0RGF0YSIsIm1lZGlhIiwiY29udGVudElkIiwibWV0YWRhdGEiLCJjdXN0b21EYXRhIiwic3RhY2siLCJhZGRCcmVha3MiLCJtZWRpYUluZm9ybWF0aW9uIiwiTE9HX1JFQ0VJVkVSX1RBRyIsImZldGNoTWVkaWFCeUlkIiwiY2xpcDEiLCJicmVha0NsaXBzIiwidGl0bGUiLCJjb250ZW50VXJsIiwic3RyZWFtIiwiZGFzaCIsImNvbnRlbnRUeXBlIiwid2hlblNraXBwYWJsZSIsImJyZWFrcyIsImJyZWFrQ2xpcElkcyIsInBvc2l0aW9uIiwiUHJvbWlzZSIsImFjY2VwdCIsInJlamVjdCIsImZldGNoIiwiQ09OVEVOVF9VUkwiLCJyZXNwb25zZSIsImpzb24iLCJvYmoiXSwic291cmNlUm9vdCI6IiJ9