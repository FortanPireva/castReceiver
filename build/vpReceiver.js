(()=>{"use strict";function t(t,e){new class{constructor(t,e){this.context=null,this.playerManager=null,this.castDebugLogger=null,this.appId=e.appId,this.video=document.querySelector(t),this.playbackConfig=null,this.controls=null,this.hls=null,this.videoObject={},this.videoContainer=this.video.parentElement}start(){this.play()}play(){this.video.play().then((()=>{})).catch((()=>{}))}attachMedia(){if(vpReceiver.HLSsupported=Hls.isSupported(),this.castDebugLogger.debug("inside attach media",vpReceiver.HLSsupported),this.video.playbackRate=1,this.castDebugLogger.debug("video file",JSON.stringify(this.video,["id","className","tagName"])),this.videoObject.file.endsWith("mp4"))this.castDebugLogger.debug("inside mp4",this.videoObject.file),this.video.src=this.videoObject.file,this.start();else if(vpReceiver.HLSsupported){this.castDebugLogger.debug("inside hlssupported",this.videoObject.file);try{this.hls=new Hls,this.castDebugLogger.debug("hls initialized",this.videoObject.file),this.hls.attachMedia(this.video),this.castDebugLogger.debug("attached media",this.videoObject.file),this.hls.on(Hls.Events.MEDIA_ATTACHED,(()=>{this.castDebugLogger.debug("amedia attached",this.videoObject.file),this.hls.startLevel=0,this.castDebugLogger.debug("loading source hlssupported",this.videoObject.file),this.hls.loadSource(this.videoObject.file)})),this.hls.on(Hls.Events.MANIFEST_PARSED,((t,e)=>{this.castDebugLogger.debug("manifest parsed",this.videoObject.file),this.start()})),this.hls.on(Hls.Events.ERROR,((t,e)=>{this.castDebugLogger.debug("HLS  ERROR",e.details)}))}catch(t){this.castDebugLogger.debug("hls error",t)}}this.castDebugLogger.debug("finished attach media")}fakeinit(){const t=cast.framework.CastReceiverContext.getInstance();t.getPlayerManager(),this.videoObject.file="https://vp.gjirafa.net/vps/prod/odgehtyo/encode/vjsmylds/mp4/360p.mp4",this.attachMedia(),t.start()}init(){this.context=cast.framework.CastReceiverContext.getInstance(),this.playerManager=this.context.getPlayerManager(),this.playerManager.setMediaElement(this.video),this.castDebugLogger=cast.debug.CastDebugLogger.getInstance(),this.context.start(),this.bindMethods(),this.bindInterceptors()}drawButtons(){this.controls.assignButton(cast.framework.ui.ControlsSlot.SLOT_SECONDARY_1,cast.framework.ui.ControlsButton.QUEUE_PREV),this.controls.assignButton(cast.framework.ui.ControlsSlot.SLOT_PRIMARY_1,cast.framework.ui.ControlsButton.CAPTIONS),this.controls.assignButton(cast.framework.ui.ControlsSlot.SLOT_PRIMARY_2,cast.framework.ui.ControlsButton.SEEK_FORWARD_15),this.controls.assignButton(cast.framework.ui.ControlsSlot.SLOT_SECONDARY_2,cast.framework.ui.ControlsButton.QUEUE_NEXT)}bindInterceptors(){this.playerManager.setMessageInterceptor(cast.framework.messages.MessageType.LOAD,this.onLoadRequest.bind(this))}bindMethods(){this.bindInterceptors=this.bindInterceptors.bind(this),this.onLoadRequest=this.onLoadRequest.bind(this),this.attachMedia=this.attachMedia.bind(this)}onLoadRequest(t){return this.castDebugLogger.debug("VPreceiver",t.media.contentId),this.castDebugLogger.debug("VPreceiver1",Hls.isSupported()),this.videoObject.file=t.media.contentId,this.attachMedia(),null}addBreaks(t){return castDebugLogger.debug(LOG_RECEIVER_TAG,"addBreaks: "+JSON.stringify(t)),fetchMediaById("fbb_ad").then((e=>{t.breakClips=[{id:"fbb_ad",title:e.title,contentUrl:e.stream.dash,contentType:"application/dash+xml",whenSkippable:5}],t.breaks=[{id:"pre-roll",breakClipIds:["fbb_ad"],position:0}]}))}fetchMediaById(t){return castDebugLogger.debug(LOG_RECEIVER_TAG,"fetching id: "+t),new Promise(((e,s)=>{fetch(CONTENT_URL).then((t=>t.json())).then((i=>{i?i[t]?e(i[t]):s(`${t} not found in repository`):s("Content repository not found.")}))}))}}(t,e).init()}t.HLSsupported=!1,window.vpReceiver=t})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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T0FBUyxDQUN4QixDQUNFeEYsR0FBSSxXQUNKeUYsYUFBYyxDQUFDLFVBQ2ZDLFNBQVUsT0FLbEJYLGVBQWUvRSxHQUdiLE9BRkFNLGdCQUFnQm1CLE1BQU1xRCxpQkFBa0IsZ0JBQWtCOUUsR0FFbkQsSUFBSTJGLFNBQVEsQ0FBQ0MsRUFBUUMsS0FDMUJDLE1BQU1DLGFBQ0g1RSxNQUFNNkUsR0FBYUEsRUFBU0MsU0FDNUI5RSxNQUFNK0UsSUFDREEsRUFDRUEsRUFBSWxHLEdBQ040RixFQUFPTSxFQUFJbEcsSUFFWDZGLEVBQVEsR0FBRTdGLDZCQUdaNkYsRUFBTyx5Q0RuVGE3RixFQUFJQyxHQUV6QmdELE9BTFhsRCxFQUFXdUIsY0FBZSxFQVExQjZFLE9BQU9wRyxXQUFhQSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdnAtcmVjZWl2ZXIvLi9zcmMvanMvdnBSZWNlaXZlci5qcyIsIndlYnBhY2s6Ly92cC1yZWNlaXZlci8uL3NyYy9qcy9tb2RlbHMvcmVjZWl2ZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlY2VpdmVyIGZyb20gXCIuL21vZGVscy9yZWNlaXZlclwiO1xyXG5cclxuLy9hIGJvb2xlYW4gdGVsbGluZyB3aGV0aGVyIEhMUyBpcyBzdXBwb3J0ZWQgaW4gdGhlIGJyb3dzZXJcclxudnBSZWNlaXZlci5ITFNzdXBwb3J0ZWQgPSBmYWxzZTtcclxuXHJcbmZ1bmN0aW9uIHZwUmVjZWl2ZXIoaWQsIGNvbmZpZykge1xyXG4gIGNvbnN0IHJlY2VpdmVyID0gbmV3IFJlY2VpdmVyKGlkLCBjb25maWcpO1xyXG5cclxuICByZWNlaXZlci5pbml0KCk7XHJcbn1cclxuXHJcbndpbmRvdy52cFJlY2VpdmVyID0gdnBSZWNlaXZlcjtcclxuIiwiaW1wb3J0IGhsc2NvbmZpZyBmcm9tIFwiLi4vY29uZmlnL2hsc0NvbmZpZ1wiO1xyXG5jbGFzcyBSZWNlaXZlciB7XHJcbiAgY29uc3RydWN0b3IoaWQsIGNvbmZpZykge1xyXG4gICAgdGhpcy5jb250ZXh0ID0gbnVsbDtcclxuICAgIHRoaXMucGxheWVyTWFuYWdlciA9IG51bGw7XHJcbiAgICB0aGlzLmNhc3REZWJ1Z0xvZ2dlciA9IG51bGw7XHJcbiAgICB0aGlzLmFwcElkID0gY29uZmlnLmFwcElkO1xyXG4gICAgdGhpcy52aWRlbyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoaWQpO1xyXG4gICAgdGhpcy5wbGF5YmFja0NvbmZpZyA9IG51bGw7XHJcbiAgICB0aGlzLmNvbnRyb2xzID0gbnVsbDtcclxuICAgIHRoaXMuaGxzID0gbnVsbDtcclxuICAgIHRoaXMudmlkZW9PYmplY3QgPSB7fTtcclxuICAgIHRoaXMudmlkZW9Db250YWluZXIgPSB0aGlzLnZpZGVvLnBhcmVudEVsZW1lbnQ7XHJcbiAgfVxyXG4gIHN0YXJ0KCkge1xyXG4gICAgdGhpcy5wbGF5KCk7XHJcbiAgfVxyXG5cclxuICBwbGF5KCkge1xyXG4gICAgLy8gcmV0dXJuIHRoaXMucGxheWVyTWFuYWdlci5wbGF5KCk7XHJcbiAgICB0aGlzLnZpZGVvXHJcbiAgICAgIC5wbGF5KClcclxuICAgICAgLnRoZW4oKCkgPT4ge30pXHJcbiAgICAgIC5jYXRjaCgoKSA9PiB7fSk7XHJcbiAgfVxyXG4gIGF0dGFjaE1lZGlhKCkge1xyXG4gICAgdnBSZWNlaXZlci5ITFNzdXBwb3J0ZWQgPSBIbHMuaXNTdXBwb3J0ZWQoKTtcclxuICAgIHRoaXMuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFwiaW5zaWRlIGF0dGFjaCBtZWRpYVwiLCB2cFJlY2VpdmVyLkhMU3N1cHBvcnRlZCk7XHJcbiAgICB0aGlzLnZpZGVvLnBsYXliYWNrUmF0ZSA9IDE7XHJcbiAgICB0aGlzLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhcclxuICAgICAgXCJ2aWRlbyBmaWxlXCIsXHJcbiAgICAgIEpTT04uc3RyaW5naWZ5KHRoaXMudmlkZW8sIFtcImlkXCIsIFwiY2xhc3NOYW1lXCIsIFwidGFnTmFtZVwiXSlcclxuICAgICk7XHJcbiAgICBpZiAodGhpcy52aWRlb09iamVjdC5maWxlLmVuZHNXaXRoKFwibXA0XCIpKSB7XHJcbiAgICAgIHRoaXMuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFwiaW5zaWRlIG1wNFwiLCB0aGlzLnZpZGVvT2JqZWN0LmZpbGUpO1xyXG4gICAgICB0aGlzLnZpZGVvLnNyYyA9IHRoaXMudmlkZW9PYmplY3QuZmlsZTtcclxuICAgICAgdGhpcy5zdGFydCgpO1xyXG4gICAgfSBlbHNlIGlmICh2cFJlY2VpdmVyLkhMU3N1cHBvcnRlZCkge1xyXG4gICAgICB0aGlzLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhcImluc2lkZSBobHNzdXBwb3J0ZWRcIiwgdGhpcy52aWRlb09iamVjdC5maWxlKTtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICB0aGlzLmhscyA9IG5ldyBIbHMoKTtcclxuICAgICAgICB0aGlzLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhcImhscyBpbml0aWFsaXplZFwiLCB0aGlzLnZpZGVvT2JqZWN0LmZpbGUpO1xyXG4gICAgICAgIHRoaXMuaGxzLmF0dGFjaE1lZGlhKHRoaXMudmlkZW8pO1xyXG4gICAgICAgIHRoaXMuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFwiYXR0YWNoZWQgbWVkaWFcIiwgdGhpcy52aWRlb09iamVjdC5maWxlKTtcclxuXHJcbiAgICAgICAgdGhpcy5obHMub24oSGxzLkV2ZW50cy5NRURJQV9BVFRBQ0hFRCwgKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5jYXN0RGVidWdMb2dnZXIuZGVidWcoXCJhbWVkaWEgYXR0YWNoZWRcIiwgdGhpcy52aWRlb09iamVjdC5maWxlKTtcclxuICAgICAgICAgIHRoaXMuaGxzLnN0YXJ0TGV2ZWwgPSAwO1xyXG4gICAgICAgICAgdGhpcy5jYXN0RGVidWdMb2dnZXIuZGVidWcoXHJcbiAgICAgICAgICAgIFwibG9hZGluZyBzb3VyY2UgaGxzc3VwcG9ydGVkXCIsXHJcbiAgICAgICAgICAgIHRoaXMudmlkZW9PYmplY3QuZmlsZVxyXG4gICAgICAgICAgKTtcclxuICAgICAgICAgIHRoaXMuaGxzLmxvYWRTb3VyY2UodGhpcy52aWRlb09iamVjdC5maWxlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmhscy5vbihIbHMuRXZlbnRzLk1BTklGRVNUX1BBUlNFRCwgKGV2ZW50LCBkYXRhKSA9PiB7XHJcbiAgICAgICAgICB0aGlzLmNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhcIm1hbmlmZXN0IHBhcnNlZFwiLCB0aGlzLnZpZGVvT2JqZWN0LmZpbGUpO1xyXG4gICAgICAgICAgdGhpcy5zdGFydCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuaGxzLm9uKEhscy5FdmVudHMuRVJST1IsIChldmVudCwgZGF0YSkgPT4ge1xyXG4gICAgICAgICAgdGhpcy5jYXN0RGVidWdMb2dnZXIuZGVidWcoXCJITFMgIEVSUk9SXCIsIGRhdGEuZGV0YWlscyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgdGhpcy5jYXN0RGVidWdMb2dnZXIuZGVidWcoXCJobHMgZXJyb3JcIiwgZXJyb3IpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyB0aGlzLmhscy5vbihIbHMuRXZlbnRzLkVSUk9SLCAoZXZlbnQsIGRhdGEpID0+IHtcclxuICAgICAgLy8gICBpZiAoZGF0YS5kZXRhaWxzID09PSBcIm1hbmlmZXN0TG9hZEVycm9yXCIpIHtcclxuICAgICAgLy8gICAgIHRoaXMudmlkZW9Db250YWluZXIuY2xhc3NMaXN0LmFkZChjc3NDbGFzc2VzLmVmZmVjdHMuaGlkZUNvbnRlbnQpO1xyXG4gICAgICAvLyAgICAgdGhpcy52aWRlb0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKGNzc0NsYXNzZXMuZWZmZWN0cy5zaG93RXJyb3IpO1xyXG4gICAgICAvLyAgIH1cclxuXHJcbiAgICAgIC8vICAgaWYgKGRhdGEuZGV0YWlscyA9PT0gXCJtYW5pZmVzdExvYWRUaW1lT3V0XCIpIHtcclxuICAgICAgLy8gICAgIHRoaXMudmlkZW9Db250YWluZXIuY2xhc3NMaXN0LmFkZChjc3NDbGFzc2VzLmVmZmVjdHMuaGlkZUNvbnRlbnQpO1xyXG4gICAgICAvLyAgICAgdGhpcy52aWRlb0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKGNzc0NsYXNzZXMuZWZmZWN0cy5zaG93RXJyb3IpO1xyXG4gICAgICAvLyAgIH1cclxuXHJcbiAgICAgIC8vICAgaWYgKGRhdGEuZGV0YWlscyA9PT0gXCJtYW5pZmVzdFBhcnNpbmdFcnJvclwiKSB7XHJcbiAgICAgIC8vICAgICB0aGlzLnZpZGVvQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoY3NzQ2xhc3Nlcy5lZmZlY3RzLmhpZGVDb250ZW50KTtcclxuICAgICAgLy8gICAgIHRoaXMudmlkZW9Db250YWluZXIuY2xhc3NMaXN0LmFkZChjc3NDbGFzc2VzLmVmZmVjdHMuc2hvd0Vycm9yKTtcclxuICAgICAgLy8gICB9XHJcblxyXG4gICAgICAvLyAgIGlmIChkYXRhLmRldGFpbHMgPT09IFwibGV2ZWxMb2FkRXJyb3JcIikge1xyXG4gICAgICAvLyAgICAgdGhpcy5yZW1vdmVMZXZlbChkYXRhLmNvbnRleHQubGV2ZWwpO1xyXG4gICAgICAvLyAgIH1cclxuXHJcbiAgICAgIC8vICAgaWYgKGRhdGEuZGV0YWlscyA9PT0gXCJmcmFnTG9hZEVycm9yXCIpIHtcclxuICAgICAgLy8gICAgIHRoaXMuZnJhZ0Vycm9yQ291bnQrKztcclxuICAgICAgLy8gICAgIC8vIHNuIHJlZmVyZXMgdG8gc2VxdWVuY2UgbnVtYmVyXHJcbiAgICAgIC8vICAgICBpZiAoZGF0YS5mcmFnLnNuID09IDApIHRoaXMuZmFpbGVkVG9Mb2FkRmlyc3RGcmFnbWVudCA9IHRydWU7XHJcbiAgICAgIC8vICAgfVxyXG5cclxuICAgICAgLy8gICBpZiAodGhpcy5sZXZlbEhhc01pc3NpbmdGcmFnbWVudHMoKSkge1xyXG4gICAgICAvLyAgICAgdGhpcy5mcmFnRXJyb3JDb3VudCA9IDA7XHJcbiAgICAgIC8vICAgICB0aGlzLnJlbW92ZUxldmVsKGRhdGEuZnJhZy5sZXZlbCk7XHJcbiAgICAgIC8vICAgICB0aGlzLmhscy5sb2FkTGV2ZWwgPSAtMTtcclxuICAgICAgLy8gICAgIGNvbnNvbGUubG9nKFwiTmV0d29yayBlcnJvciBlbmNvdW50ZXJlZFwiKTtcclxuICAgICAgLy8gICB9XHJcblxyXG4gICAgICAvLyAgIGlmICh0aGlzLmZhaWxlZFRvTG9hZEZpcnN0RnJhZ21lbnQpIHtcclxuICAgICAgLy8gICAgIHRoaXMuZmFpbGVkVG9Mb2FkRmlyc3RGcmFnbWVudCA9IGZhbHNlO1xyXG4gICAgICAvLyAgICAgdGhpcy5yZW1vdmVMZXZlbChkYXRhLmZyYWcubGV2ZWwpO1xyXG4gICAgICAvLyAgICAgdGhpcy5obHMubG9hZExldmVsID0gLTE7XHJcbiAgICAgIC8vICAgICB0aGlzLm9uUGxheSgpO1xyXG4gICAgICAvLyAgICAgY29uc29sZS5sb2coXCJOZXR3b3JrIGVycm9yIGVuY291bnRlcmVkXCIpO1xyXG4gICAgICAvLyAgIH1cclxuXHJcbiAgICAgIC8vICAgaWYgKCFkYXRhLmZhdGFsKSB7XHJcbiAgICAgIC8vICAgICByZXR1cm47XHJcbiAgICAgIC8vICAgfVxyXG5cclxuICAgICAgLy8gICBzd2l0Y2ggKGRhdGEudHlwZSkge1xyXG4gICAgICAvLyAgICAgY2FzZSBIbHMuRXJyb3JUeXBlcy5ORVRXT1JLX0VSUk9SOlxyXG4gICAgICAvLyAgICAgICBjb25zb2xlLmxvZyhcImZhdGFsIG5ldHdvcmsgZXJyb3IgZW5jb3VudGVyZWRcIik7XHJcbiAgICAgIC8vICAgICAgIHRoaXMuaGxzLnN0YXJ0TG9hZCgpO1xyXG4gICAgICAvLyAgICAgICBicmVhaztcclxuICAgICAgLy8gICAgIGNhc2UgSGxzLkVycm9yVHlwZXMuTUVESUFfRVJST1I6XHJcbiAgICAgIC8vICAgICAgIGNvbnNvbGUubG9nKFwiZmF0YWwgbWVkaWEgZXJyb3IgZW5jb3VudGVyZWRcIik7XHJcbiAgICAgIC8vICAgICAgIHRoaXMuaGxzLnJlY292ZXJNZWRpYUVycm9yKCk7XHJcbiAgICAgIC8vICAgICAgIGJyZWFrO1xyXG4gICAgICAvLyAgICAgZGVmYXVsdDpcclxuICAgICAgLy8gICAgICAgdGhpcy5obHMuZGVzdHJveSgpO1xyXG4gICAgICAvLyAgICAgICBicmVhaztcclxuICAgICAgLy8gICB9XHJcbiAgICAgIC8vIH0pO1xyXG4gICAgfVxyXG4gICAgdGhpcy5jYXN0RGVidWdMb2dnZXIuZGVidWcoXCJmaW5pc2hlZCBhdHRhY2ggbWVkaWFcIik7XHJcbiAgICAvLyAgZWxzZSBpZiAodGhpcy52aWRlby5jYW5QbGF5VHlwZShcImFwcGxpY2F0aW9uL3ZuZC5hcHBsZS5tcGVndXJsXCIpKSB7XHJcbiAgICAvLyAgIHRoaXMudmlkZW8uc3JjID0gdGhpcy52aWRlb09iamVjdC5maWxlO1xyXG4gICAgLy8gICBpZiAoVXRpbHMuaXNJT1MoKSkge1xyXG4gICAgLy8gICAgIGZwc19kcm0uaW5pdChcclxuICAgIC8vICAgICAgIHRoaXMudmlkZW8sXHJcbiAgICAvLyAgICAgICBjb25maWcuZnBzQ2VydGlmaWNhdGVVcmwsXHJcbiAgICAvLyAgICAgICB0aGlzLnZpZGVvT2JqZWN0LmFzc2V0SWRcclxuICAgIC8vICAgICApO1xyXG4gICAgLy8gICB9XHJcbiAgICAvLyAgIHRoaXMudmlkZW8ucGxheXNJbmxpbmUgPSB0cnVlO1xyXG4gICAgLy8gICB0aGlzLnN0YXJ0KCk7XHJcbiAgICAvLyB9XHJcbiAgfVxyXG4gIGZha2Vpbml0KCkge1xyXG4gICAgY29uc3QgY29udGV4dCA9IGNhc3QuZnJhbWV3b3JrLkNhc3RSZWNlaXZlckNvbnRleHQuZ2V0SW5zdGFuY2UoKTtcclxuICAgIGNvbnN0IHBsYXllck1hbmFnZXIgPSBjb250ZXh0LmdldFBsYXllck1hbmFnZXIoKTtcclxuICAgIC8vIHRoaXMuY2FzdERlYnVnTG9nZ2VyID0gY2FzdC5kZWJ1Zy5DYXN0RGVidWdMb2dnZXIuZ2V0SW5zdGFuY2UoKTtcclxuICAgIHRoaXMudmlkZW9PYmplY3QuZmlsZSA9XHJcbiAgICAgIFwiaHR0cHM6Ly92cC5namlyYWZhLm5ldC92cHMvcHJvZC9vZGdlaHR5by9lbmNvZGUvdmpzbXlsZHMvbXA0LzM2MHAubXA0XCI7XHJcbiAgICB0aGlzLmF0dGFjaE1lZGlhKCk7XHJcbiAgICBjb250ZXh0LnN0YXJ0KCk7XHJcbiAgfVxyXG4gIGluaXQoKSB7XHJcbiAgICAvLyB0aGlzLmJpbmRNZXRob2RzKCk7XHJcbiAgICB0aGlzLmNvbnRleHQgPSBjYXN0LmZyYW1ld29yay5DYXN0UmVjZWl2ZXJDb250ZXh0LmdldEluc3RhbmNlKCk7XHJcbiAgICB0aGlzLnBsYXllck1hbmFnZXIgPSB0aGlzLmNvbnRleHQuZ2V0UGxheWVyTWFuYWdlcigpO1xyXG4gICAgdGhpcy5wbGF5ZXJNYW5hZ2VyLnNldE1lZGlhRWxlbWVudCh0aGlzLnZpZGVvKTtcclxuICAgIHRoaXMuY2FzdERlYnVnTG9nZ2VyID0gY2FzdC5kZWJ1Zy5DYXN0RGVidWdMb2dnZXIuZ2V0SW5zdGFuY2UoKTtcclxuICAgIC8vIHRoaXMuY2FzdERlYnVnTG9nZ2VyLnNldEVuYWJsZWQodHJ1ZSk7XHJcbiAgICAvLyB0aGlzLnBsYXliYWNrQ29uZmlnLmF1dG9SZXN1bWVEdXJhdGlvbiA9IDU7XHJcbiAgICAvLyB0aGlzLmNhc3REZWJ1Z0xvZ2dlci5pbmZvKExPR19SRUNFSVZFUl9UQUcsIGBhdXRvaW5pdDogYCk7XHJcbiAgICAvLyB0aGlzLmNvbnRyb2xzLmNsZWFyRGVmYXVsdFNsb3RBc3NpZ25tZW50cygpO1xyXG4gICAgLy8gdGhpcy5kcmF3QnV0dG9ucygpO1xyXG5cclxuICAgIC8vIGNvbnRleHQuc3RhcnQoe1xyXG4gICAgLy8gICBxdWV1ZTogbmV3IENhc3RRdWV1ZSgpLFxyXG4gICAgLy8gICBwbGF5YmFja0NvbmZpZzogdGhpcy5wbGF5YmFja0NvbmZpZyxcclxuICAgIC8vICAgc3VwcG9ydGVkQ29tbWFuZHM6XHJcbiAgICAvLyAgICAgY2FzdC5mcmFtZXdvcmsubWVzc2FnZXMuQ29tbWFuZC5BTExfQkFTSUNfTUVESUEgfFxyXG4gICAgLy8gICAgIGNhc3QuZnJhbWV3b3JrLm1lc3NhZ2VzLkNvbW1hbmQuUVVFVUVfUFJFViB8XHJcbiAgICAvLyAgICAgY2FzdC5mcmFtZXdvcmsubWVzc2FnZXMuQ29tbWFuZC5RVUVVRV9ORVhUIHxcclxuICAgIC8vICAgICBjYXN0LmZyYW1ld29yay5tZXNzYWdlcy5Db21tYW5kLlNUUkVBTV9UUkFOU0ZFUixcclxuICAgIC8vIH0pO1xyXG4gICAgLy8gdGhpcy5iaW5kSW50ZXJjZXB0b3JzKCk7XHJcbiAgICAvLyB0aGlzLnZpZGVvT2JqZWN0LmZpbGUgPVxyXG4gICAgLy8gICBcImh0dHBzOi8vdnAuZ2ppcmFmYS5uZXQvdnBzL3Byb2Qvb2RnZWh0eW8vZW5jb2RlL3Zqc215bGRzL21wNC8zNjBwLm1wNFwiO1xyXG4gICAgLy8gdGhpcy5hdHRhY2hNZWRpYSgpO1xyXG4gICAgdGhpcy5jb250ZXh0LnN0YXJ0KCk7XHJcbiAgICB0aGlzLmJpbmRNZXRob2RzKCk7XHJcbiAgICB0aGlzLmJpbmRJbnRlcmNlcHRvcnMoKTtcclxuICB9XHJcbiAgZHJhd0J1dHRvbnMoKSB7XHJcbiAgICB0aGlzLmNvbnRyb2xzLmFzc2lnbkJ1dHRvbihcclxuICAgICAgY2FzdC5mcmFtZXdvcmsudWkuQ29udHJvbHNTbG90LlNMT1RfU0VDT05EQVJZXzEsXHJcbiAgICAgIGNhc3QuZnJhbWV3b3JrLnVpLkNvbnRyb2xzQnV0dG9uLlFVRVVFX1BSRVZcclxuICAgICk7XHJcbiAgICB0aGlzLmNvbnRyb2xzLmFzc2lnbkJ1dHRvbihcclxuICAgICAgY2FzdC5mcmFtZXdvcmsudWkuQ29udHJvbHNTbG90LlNMT1RfUFJJTUFSWV8xLFxyXG4gICAgICBjYXN0LmZyYW1ld29yay51aS5Db250cm9sc0J1dHRvbi5DQVBUSU9OU1xyXG4gICAgKTtcclxuICAgIHRoaXMuY29udHJvbHMuYXNzaWduQnV0dG9uKFxyXG4gICAgICBjYXN0LmZyYW1ld29yay51aS5Db250cm9sc1Nsb3QuU0xPVF9QUklNQVJZXzIsXHJcbiAgICAgIGNhc3QuZnJhbWV3b3JrLnVpLkNvbnRyb2xzQnV0dG9uLlNFRUtfRk9SV0FSRF8xNVxyXG4gICAgKTtcclxuICAgIHRoaXMuY29udHJvbHMuYXNzaWduQnV0dG9uKFxyXG4gICAgICBjYXN0LmZyYW1ld29yay51aS5Db250cm9sc1Nsb3QuU0xPVF9TRUNPTkRBUllfMixcclxuICAgICAgY2FzdC5mcmFtZXdvcmsudWkuQ29udHJvbHNCdXR0b24uUVVFVUVfTkVYVFxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGJpbmRJbnRlcmNlcHRvcnMoKSB7XHJcbiAgICB0aGlzLnBsYXllck1hbmFnZXIuc2V0TWVzc2FnZUludGVyY2VwdG9yKFxyXG4gICAgICBjYXN0LmZyYW1ld29yay5tZXNzYWdlcy5NZXNzYWdlVHlwZS5MT0FELFxyXG4gICAgICB0aGlzLm9uTG9hZFJlcXVlc3QuYmluZCh0aGlzKVxyXG4gICAgKTtcclxuICB9XHJcbiAgYmluZE1ldGhvZHMoKSB7XHJcbiAgICB0aGlzLmJpbmRJbnRlcmNlcHRvcnMgPSB0aGlzLmJpbmRJbnRlcmNlcHRvcnMuYmluZCh0aGlzKTtcclxuICAgIHRoaXMub25Mb2FkUmVxdWVzdCA9IHRoaXMub25Mb2FkUmVxdWVzdC5iaW5kKHRoaXMpO1xyXG4gICAgdGhpcy5hdHRhY2hNZWRpYSA9IHRoaXMuYXR0YWNoTWVkaWEuYmluZCh0aGlzKTtcclxuICB9XHJcbiAgb25Mb2FkUmVxdWVzdChsb2FkUmVxdWVzdERhdGEpIHtcclxuICAgIC8vIElmIHRoZSBsb2FkUmVxdWVzdERhdGEgaXMgaW5jb21wbGV0ZSByZXR1cm4gYW4gZXJyb3IgbWVzc2FnZVxyXG4gICAgLy8gaWYgKCFsb2FkUmVxdWVzdERhdGEgfHwgIWxvYWRSZXF1ZXN0RGF0YS5tZWRpYSkge1xyXG4gICAgLy8gICBjb25zdCBlcnJvciA9IG5ldyBjYXN0LmZyYW1ld29yay5tZXNzYWdlcy5FcnJvckRhdGEoXHJcbiAgICAvLyAgICAgY2FzdC5mcmFtZXdvcmsubWVzc2FnZXMuRXJyb3JUeXBlLkxPQURfRkFJTEVEXHJcbiAgICAvLyAgICk7XHJcbiAgICAvLyAgIGVycm9yLnJlYXNvbiA9IGNhc3QuZnJhbWV3b3JrLm1lc3NhZ2VzLkVycm9yUmVhc29uLklOVkFMSURfUkVRVUVTVDtcclxuICAgIC8vICAgcmV0dXJuIGVycm9yO1xyXG4gICAgLy8gfVxyXG5cclxuICAgIC8vIC8vIGNoZWNrIGFsbCBjb250ZW50IHNvdXJjZSBmaWVsZHMgZm9yIGFzc2V0IFVSTCBvciBJRFxyXG4gICAgLy8gbGV0IHNvdXJjZSA9XHJcbiAgICAvLyAgIGxvYWRSZXF1ZXN0RGF0YS5tZWRpYS5jb250ZW50VXJsIHx8XHJcbiAgICAvLyAgIGxvYWRSZXF1ZXN0RGF0YS5tZWRpYS5lbnRpdHkgfHxcclxuICAgIC8vICAgbG9hZFJlcXVlc3REYXRhLm1lZGlhLmNvbnRlbnRJZDtcclxuICAgIHRoaXMuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFwiVlByZWNlaXZlclwiLCBsb2FkUmVxdWVzdERhdGEubWVkaWEuY29udGVudElkKTtcclxuICAgIHRoaXMuY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFwiVlByZWNlaXZlcjFcIiwgSGxzLmlzU3VwcG9ydGVkKCkpO1xyXG4gICAgdGhpcy52aWRlb09iamVjdC5maWxlID0gbG9hZFJlcXVlc3REYXRhLm1lZGlhLmNvbnRlbnRJZDtcclxuICAgIHRoaXMuYXR0YWNoTWVkaWEoKTtcclxuICAgIHJldHVybiBudWxsO1xyXG4gICAgLy8gSWYgdGhlcmUgaXMgbm8gc291cmNlIG9yIGEgbWFsZm9ybWVkIElEIHRoZW4gcmV0dXJuIGFuIGVycm9yLlxyXG4gICAgaWYgKCFzb3VyY2UgfHwgc291cmNlID09IFwiXCIgfHwgIXNvdXJjZS5tYXRjaChJRF9SRUdFWCkpIHtcclxuICAgICAgbGV0IGVycm9yID0gbmV3IGNhc3QuZnJhbWV3b3JrLm1lc3NhZ2VzLkVycm9yRGF0YShcclxuICAgICAgICBjYXN0LmZyYW1ld29yay5tZXNzYWdlcy5FcnJvclR5cGUuTE9BRF9GQUlMRURcclxuICAgICAgKTtcclxuICAgICAgZXJyb3IucmVhc29uID0gY2FzdC5mcmFtZXdvcmsubWVzc2FnZXMuRXJyb3JSZWFzb24uSU5WQUxJRF9SRVFVRVNUO1xyXG4gICAgICByZXR1cm4gZXJyb3I7XHJcbiAgICB9XHJcblxyXG4gICAgbGV0IHNvdXJjZUlkID0gc291cmNlLm1hdGNoKElEX1JFR0VYKVsxXTtcclxuXHJcbiAgICAvLyBBZGQgYnJlYWtzIHRvIHRoZSBtZWRpYSBpbmZvcm1hdGlvbiBhbmQgc2V0IHRoZSBjb250ZW50VXJsXHJcbiAgICByZXR1cm4gYWRkQnJlYWtzKGxvYWRSZXF1ZXN0RGF0YS5tZWRpYSlcclxuICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgIC8vIElmIHRoZSBzb3VyY2UgaXMgYSB1cmwgdGhhdCBwb2ludHMgdG8gYW4gYXNzZXQgZG9uJ3QgZmV0Y2ggZnJvbSBiYWNrZW5kXHJcbiAgICAgICAgaWYgKHNvdXJjZUlkLmluY2x1ZGVzKFwiLlwiKSkge1xyXG4gICAgICAgICAgY2FzdERlYnVnTG9nZ2VyLmRlYnVnKFxyXG4gICAgICAgICAgICBMT0dfUkVDRUlWRVJfVEFHLFxyXG4gICAgICAgICAgICBcIkludGVyY2VwdG9yIHJlY2VpdmVkIGZ1bGwgVVJMXCJcclxuICAgICAgICAgICk7XHJcbiAgICAgICAgICBsb2FkUmVxdWVzdERhdGEubWVkaWEuY29udGVudFVybCA9IHNvdXJjZTtcclxuICAgICAgICAgIHJldHVybiBsb2FkUmVxdWVzdERhdGE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBGZXRjaCB0aGUgY29udGVudFVybCBpZiBwcm92aWRlZCBhbiBJRCBvciBlbnRpdHkgVVJMXHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICBjYXN0RGVidWdMb2dnZXIuZGVidWcoTE9HX1JFQ0VJVkVSX1RBRywgXCJJbnRlcmNlcHRvciByZWNlaXZlZCBJRFwiKTtcclxuICAgICAgICAgIHJldHVybiB0aGlzLmZldGNoTWVkaWFCeUlkKHNvdXJjZUlkKS50aGVuKChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBtZXRhZGF0YSA9IG5ldyBjYXN0LmZyYW1ld29yay5tZXNzYWdlcy5HZW5lcmljTWVkaWFNZXRhZGF0YSgpO1xyXG4gICAgICAgICAgICBtZXRhZGF0YS50aXRsZSA9IGl0ZW0udGl0bGU7XHJcbiAgICAgICAgICAgIG1ldGFkYXRhLnN1YnRpdGxlID0gaXRlbS5kZXNjcmlwdGlvbjtcclxuICAgICAgICAgICAgbG9hZFJlcXVlc3REYXRhLm1lZGlhLmNvbnRlbnRJZCA9IGl0ZW0uc3RyZWFtLmRhc2g7XHJcbiAgICAgICAgICAgIGxvYWRSZXF1ZXN0RGF0YS5tZWRpYS5jb250ZW50VHlwZSA9IFwiYXBwbGljYXRpb24vZGFzaCt4bWxcIjtcclxuICAgICAgICAgICAgbG9hZFJlcXVlc3REYXRhLm1lZGlhLm1ldGFkYXRhID0gbWV0YWRhdGE7XHJcbiAgICAgICAgICAgIHJldHVybiBsb2FkUmVxdWVzdERhdGE7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyb3JNZXNzYWdlKSA9PiB7XHJcbiAgICAgICAgbGV0IGVycm9yID0gbmV3IGNhc3QuZnJhbWV3b3JrLm1lc3NhZ2VzLkVycm9yRGF0YShcclxuICAgICAgICAgIGNhc3QuZnJhbWV3b3JrLm1lc3NhZ2VzLkVycm9yVHlwZS5MT0FEX0ZBSUxFRFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgZXJyb3IucmVhc29uID0gY2FzdC5mcmFtZXdvcmsubWVzc2FnZXMuRXJyb3JSZWFzb24uSU5WQUxJRF9SRVFVRVNUO1xyXG4gICAgICAgIGNhc3REZWJ1Z0xvZ2dlci5lcnJvcihMT0dfUkVDRUlWRVJfVEFHLCBlcnJvck1lc3NhZ2UpO1xyXG4gICAgICAgIHJldHVybiBlcnJvcjtcclxuICAgICAgfSk7XHJcbiAgfVxyXG4gIGFkZEJyZWFrcyhtZWRpYUluZm9ybWF0aW9uKSB7XHJcbiAgICBjYXN0RGVidWdMb2dnZXIuZGVidWcoXHJcbiAgICAgIExPR19SRUNFSVZFUl9UQUcsXHJcbiAgICAgIFwiYWRkQnJlYWtzOiBcIiArIEpTT04uc3RyaW5naWZ5KG1lZGlhSW5mb3JtYXRpb24pXHJcbiAgICApO1xyXG4gICAgcmV0dXJuIGZldGNoTWVkaWFCeUlkKFwiZmJiX2FkXCIpLnRoZW4oKGNsaXAxKSA9PiB7XHJcbiAgICAgIG1lZGlhSW5mb3JtYXRpb24uYnJlYWtDbGlwcyA9IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICBpZDogXCJmYmJfYWRcIixcclxuICAgICAgICAgIHRpdGxlOiBjbGlwMS50aXRsZSxcclxuICAgICAgICAgIGNvbnRlbnRVcmw6IGNsaXAxLnN0cmVhbS5kYXNoLFxyXG4gICAgICAgICAgY29udGVudFR5cGU6IFwiYXBwbGljYXRpb24vZGFzaCt4bWxcIixcclxuICAgICAgICAgIHdoZW5Ta2lwcGFibGU6IDUsXHJcbiAgICAgICAgfSxcclxuICAgICAgXTtcclxuXHJcbiAgICAgIG1lZGlhSW5mb3JtYXRpb24uYnJlYWtzID0gW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIGlkOiBcInByZS1yb2xsXCIsXHJcbiAgICAgICAgICBicmVha0NsaXBJZHM6IFtcImZiYl9hZFwiXSxcclxuICAgICAgICAgIHBvc2l0aW9uOiAwLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIF07XHJcbiAgICB9KTtcclxuICB9XHJcbiAgZmV0Y2hNZWRpYUJ5SWQoaWQpIHtcclxuICAgIGNhc3REZWJ1Z0xvZ2dlci5kZWJ1ZyhMT0dfUkVDRUlWRVJfVEFHLCBcImZldGNoaW5nIGlkOiBcIiArIGlkKTtcclxuXHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKGFjY2VwdCwgcmVqZWN0KSA9PiB7XHJcbiAgICAgIGZldGNoKENPTlRFTlRfVVJMKVxyXG4gICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gcmVzcG9uc2UuanNvbigpKVxyXG4gICAgICAgIC50aGVuKChvYmopID0+IHtcclxuICAgICAgICAgIGlmIChvYmopIHtcclxuICAgICAgICAgICAgaWYgKG9ialtpZF0pIHtcclxuICAgICAgICAgICAgICBhY2NlcHQob2JqW2lkXSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgcmVqZWN0KGAke2lkfSBub3QgZm91bmQgaW4gcmVwb3NpdG9yeWApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZWplY3QoXCJDb250ZW50IHJlcG9zaXRvcnkgbm90IGZvdW5kLlwiKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgUmVjZWl2ZXI7XHJcbiJdLCJuYW1lcyI6WyJ2cFJlY2VpdmVyIiwiaWQiLCJjb25maWciLCJjb25zdHJ1Y3RvciIsInRoaXMiLCJjb250ZXh0IiwicGxheWVyTWFuYWdlciIsImNhc3REZWJ1Z0xvZ2dlciIsImFwcElkIiwidmlkZW8iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJwbGF5YmFja0NvbmZpZyIsImNvbnRyb2xzIiwiaGxzIiwidmlkZW9PYmplY3QiLCJ2aWRlb0NvbnRhaW5lciIsInBhcmVudEVsZW1lbnQiLCJzdGFydCIsInBsYXkiLCJ0aGVuIiwiY2F0Y2giLCJhdHRhY2hNZWRpYSIsIkhMU3N1cHBvcnRlZCIsIkhscyIsImlzU3VwcG9ydGVkIiwiZGVidWciLCJwbGF5YmFja1JhdGUiLCJKU09OIiwic3RyaW5naWZ5IiwiZmlsZSIsImVuZHNXaXRoIiwic3JjIiwib24iLCJFdmVudHMiLCJNRURJQV9BVFRBQ0hFRCIsInN0YXJ0TGV2ZWwiLCJsb2FkU291cmNlIiwiTUFOSUZFU1RfUEFSU0VEIiwiZXZlbnQiLCJkYXRhIiwiRVJST1IiLCJkZXRhaWxzIiwiZXJyb3IiLCJmYWtlaW5pdCIsImNhc3QiLCJmcmFtZXdvcmsiLCJDYXN0UmVjZWl2ZXJDb250ZXh0IiwiZ2V0SW5zdGFuY2UiLCJnZXRQbGF5ZXJNYW5hZ2VyIiwiaW5pdCIsInNldE1lZGlhRWxlbWVudCIsIkNhc3REZWJ1Z0xvZ2dlciIsImJpbmRNZXRob2RzIiwiYmluZEludGVyY2VwdG9ycyIsImRyYXdCdXR0b25zIiwiYXNzaWduQnV0dG9uIiwidWkiLCJDb250cm9sc1Nsb3QiLCJTTE9UX1NFQ09OREFSWV8xIiwiQ29udHJvbHNCdXR0b24iLCJRVUVVRV9QUkVWIiwiU0xPVF9QUklNQVJZXzEiLCJDQVBUSU9OUyIsIlNMT1RfUFJJTUFSWV8yIiwiU0VFS19GT1JXQVJEXzE1IiwiU0xPVF9TRUNPTkRBUllfMiIsIlFVRVVFX05FWFQiLCJzZXRNZXNzYWdlSW50ZXJjZXB0b3IiLCJtZXNzYWdlcyIsIk1lc3NhZ2VUeXBlIiwiTE9BRCIsIm9uTG9hZFJlcXVlc3QiLCJiaW5kIiwibG9hZFJlcXVlc3REYXRhIiwibWVkaWEiLCJjb250ZW50SWQiLCJhZGRCcmVha3MiLCJtZWRpYUluZm9ybWF0aW9uIiwiTE9HX1JFQ0VJVkVSX1RBRyIsImZldGNoTWVkaWFCeUlkIiwiY2xpcDEiLCJicmVha0NsaXBzIiwidGl0bGUiLCJjb250ZW50VXJsIiwic3RyZWFtIiwiZGFzaCIsImNvbnRlbnRUeXBlIiwid2hlblNraXBwYWJsZSIsImJyZWFrcyIsImJyZWFrQ2xpcElkcyIsInBvc2l0aW9uIiwiUHJvbWlzZSIsImFjY2VwdCIsInJlamVjdCIsImZldGNoIiwiQ09OVEVOVF9VUkwiLCJyZXNwb25zZSIsImpzb24iLCJvYmoiLCJ3aW5kb3ciXSwic291cmNlUm9vdCI6IiJ9